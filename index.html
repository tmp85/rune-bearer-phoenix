<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üè∞ Rune Bearer Phoenix - Summer Challenge üè∞</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;500;600;700&family=Almendra:wght@400;700&display=swap" rel="stylesheet">
    <script src="gameSchedule.js"></script>
    <style>
        /* Updated Color Palette */
        :root {
            --primary-green: #22c55e;
            --secondary-blue: #3b82f6;
            --primary-orange: #f97316;
            --success-green: #22c55e;
            --gray-light: #e5e7eb;
            --gray-medium: #9ca3af;
            --gray-dark: #374151;
            --gray-darker: #1f2937;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #1a1a2e, #16213e, #0f3460);
            background-image: url('assets/backgrounds/RuWg9QG2E9Z5L3trxaTX--0--eyvrg.jpg');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            background-repeat: no-repeat;
            color: #fff;
            min-height: 100vh;
            overflow-x: auto;
        }

        .game-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px 10px 10px 10px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
            min-height: 100vh;
        }

        .header {
            text-align: center;
            padding: 30px;
            background: rgba(31, 41, 55, 0.95);
            border: 3px solid #fbbf24;
            border-radius: 20px;
            margin-bottom: 30px;
            box-shadow: 0 0 30px rgba(251, 191, 36, 0.4);
            position: relative;
        }

        .header::before {
            content: '';
            position: absolute;
            top: -3px;
            left: -3px;
            right: -3px;
            bottom: -3px;
            background: linear-gradient(45deg, #fbbf24, #f59e0b, #d97706);
            border-radius: 20px;
            z-index: -1;
            opacity: 0.3;
        }

        .header h1 {
            font-family: 'Cinzel', serif;
            font-size: 2.8em;
            text-shadow: 2px 2px 8px rgba(0,0,0,0.7);
            margin-bottom: 10px;
            font-weight: 600;
            color: #fbbf24;
            background: linear-gradient(45deg, #fbbf24, #fcd34d, #fbbf24);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .date-info {
            font-size: 1.2em;
            opacity: 0.9;
            color: var(--gray-light);
            font-weight: 500;
        }

        .main-layout {
            display: grid;
            grid-template-columns: 280px 400px 280px;
            gap: 25px;
            margin-bottom: 30px;
            justify-content: center;
            width: 100%;
            max-width: 1010px;
        }

        .player-card {
            background: rgba(31, 41, 55, 0.95);
            border-radius: 20px;
            padding: 25px;
            text-align: center;
            cursor: pointer;
            transition: all 0.4s ease;
            border: 3px solid transparent;
            position: relative;
            overflow: hidden;
        }

        .player-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(0,0,0,0.4), rgba(0,0,0,0.2));
            z-index: -1;
        }

        .wells-card {
            border-color: var(--primary-orange);
            box-shadow: 0 0 25px rgba(249, 115, 22, 0.3);
        }

        .wells-card:hover {
            border-color: var(--primary-orange);
            transform: translateY(-5px) scale(1.02);
            box-shadow: 0 15px 40px rgba(249, 115, 22, 0.5);
        }

        .rou-card {
            border-color: var(--secondary-blue);
            box-shadow: 0 0 25px rgba(59, 130, 246, 0.3);
        }

        .rou-card:hover {
            border-color: var(--secondary-blue);
            transform: translateY(-5px) scale(1.02);
            box-shadow: 0 15px 40px rgba(59, 130, 246, 0.5);
        }

        .avatar {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            margin: 0 auto 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 52px;
            border: 4px solid;
            transition: all 0.3s ease;
            overflow: hidden; /* Ensures image stays within circular bounds */
        }

        .avatar-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            object-position: center;
            border-radius: 50%;
        }

        .wells-avatar {
            background: linear-gradient(135deg, var(--primary-orange), #f59e0b);
            border-color: #fbbf24;
            box-shadow: 0 0 20px rgba(249, 115, 22, 0.4);
        }

        .rou-avatar {
            background: linear-gradient(135deg, var(--secondary-blue), #1d4ed8);
            border-color: #60a5fa;
            box-shadow: 0 0 20px rgba(59, 130, 246, 0.4);
        }

        .player-card:hover .avatar {
            transform: scale(1.1);
            box-shadow: 0 0 30px rgba(255, 255, 255, 0.2);
        }

        .player-name {
            font-size: 2em;
            font-weight: bold;
            margin-bottom: 15px;
            color: white;
        }

        .current-room {
            font-family: 'Almendra', serif;
            font-size: 1.3em;
            opacity: 0.9;
            margin-bottom: 12px;
            color: var(--gray-light);
            font-weight: 500;
        }

        .day-info {
            font-size: 1em;
            opacity: 0.8;
            margin-bottom: 20px;
            color: var(--gray-medium);
            font-weight: 400;
        }

        /* Center Content Area */
        .center-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
            background: rgba(55, 65, 81, 0.95);
            border: 3px solid var(--primary-green);
            border-radius: 20px;
            padding: 25px;
            transition: all 0.3s ease;
            height: 600px;
            box-shadow: 0 0 25px rgba(34, 197, 94, 0.3);
        }

        .center-content:hover {
            border-color: var(--primary-green);
            box-shadow: 0 0 30px rgba(34, 197, 94, 0.4);
        }

        .center-placeholder {
            text-align: center;
            opacity: 0.7;
        }

        .center-placeholder .icon {
            font-size: 3.5em;
            margin-bottom: 15px;
            background: linear-gradient(45deg, var(--primary-green), var(--secondary-blue));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .center-placeholder .title {
            font-size: 1.3em;
            font-weight: bold;
            margin-bottom: 8px;
            color: var(--gray-light);
        }

        .center-placeholder .subtitle {
            font-size: 0.9em;
            color: var(--gray-medium);
            font-style: italic;
        }

        /* Room View Modal */
        .room-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.9);
            z-index: 1000;
            overflow-y: auto;
        }

        .room-content {
            max-width: 800px;
            margin: 20px auto;
            padding: 20px;
            position: relative;
        }

        .room-header {
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            margin: 0 auto 20px auto;
            max-width: 600px;
        }

        /* Wells room header (orange theme) */
        .room-header.wells-theme {
            background: linear-gradient(135deg, rgba(249, 115, 22, 0.2), rgba(249, 115, 22, 0.1));
            border: 3px solid var(--primary-orange);
            box-shadow: 0 0 30px rgba(249, 115, 22, 0.3);
        }

        /* Rou room header (blue theme) */
        .room-header.rou-theme {
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.2), rgba(59, 130, 246, 0.1));
            border: 3px solid var(--secondary-blue);
            box-shadow: 0 0 30px rgba(59, 130, 246, 0.3);
        }

        .room-title {
            font-family: 'Cinzel', serif;
            font-size: 2em;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            font-weight: 600;
        }

        /* Wells room title (orange) */
        .room-title.wells-theme {
            color: var(--primary-orange);
        }

        /* Rou room title (blue) */
        .room-title.rou-theme {
            color: var(--secondary-blue);
        }

        .room-subtitle {
            font-family: 'Cinzel', serif;
            font-size: 1.2em;
            color: #f59e0b;
            margin-bottom: 15px;
            font-weight: 500;
        }

        .room-artwork {
            width: 100%;
            max-width: 400px;
            aspect-ratio: 1 / 1;
            object-fit: cover;
            border-radius: 15px;
            margin: 0 auto 20px auto;
            border: 3px solid;
            box-shadow: 0 0 20px;
            display: block;
        }

        /* Wells artwork border (orange theme) */
        .room-artwork.wells-theme {
            border-color: var(--primary-orange);
            box-shadow: 0 0 20px rgba(249, 115, 22, 0.3);
        }

        /* Rou artwork border (blue) */
        .room-artwork.rou-theme {
            border-color: var(--secondary-blue);
            box-shadow: 0 0 20px rgba(59, 130, 246, 0.3);
        }

        .story-section {
            background: rgba(0,0,0,0.5);
            border-left: 4px solid var(--secondary-blue);
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 0 10px 10px 0;
            font-style: italic;
            line-height: 1.6;
            font-size: 1.9em;
        }

        .challenges-section {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-bottom: 20px;
            max-width: 500px;
            margin-left: auto;
            margin-right: auto;
        }

        .challenge-btn {
            padding: 18px 24px;
            border: none;
            border-radius: 12px;
            font-size: 1.2em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            border: 2px solid transparent;
            width: 100%;
        }

        .irl-challenge-btn {
            background: linear-gradient(135deg, var(--primary-orange), #f59e0b);
            color: white;
            border-color: var(--primary-orange);
        }

        .irl-challenge-btn:hover:not(.completed) {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(249, 115, 22, 0.4);
        }

        .math-challenge-btn {
            background: linear-gradient(135deg, var(--secondary-blue), #1d4ed8);
            color: white;
            border-color: var(--secondary-blue);
        }

        .math-challenge-btn:hover:not(:disabled):not(.completed) {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(59, 130, 246, 0.4);
        }

        .math-challenge-btn:disabled {
            background: linear-gradient(135deg, var(--gray-dark), var(--gray-medium));
            border-color: var(--gray-medium);
            cursor: not-allowed;
            opacity: 0.6;
        }

        .challenge-btn.completed {
            background: linear-gradient(135deg, var(--success-green), #16a34a);
            border-color: var(--success-green);
            cursor: not-allowed;
        }

        .challenge-btn.completed:hover {
            transform: none;
            box-shadow: none;
        }

        /* Challenge Content Sections */
        .challenge-content {
            display: none;
            border-radius: 15px;
            padding: 20px;
            margin: 20px auto 20px auto;
            max-width: 600px;
            border: 2px solid;
        }

        /* Wells challenge content (orange theme) */
        .challenge-content.wells-theme {
            background: rgba(0,0,0,0.7);
            border-color: var(--primary-orange);
        }

        /* Rou challenge content (blue theme) */
        .challenge-content.rou-theme {
            background: rgba(0,0,0,0.7);
            border-color: var(--secondary-blue);
        }

        .challenge-content.active {
            display: block;
        }

        .challenge-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid rgba(255,255,255,0.1);
        }

        .challenge-icon {
            font-size: 2em;
        }

        .challenge-title {
            font-family: 'Cinzel', serif;
            font-size: 1.5em;
            font-weight: 600;
        }

        /* Wells challenge title (orange) */
        .challenge-title.wells-theme {
            color: var(--primary-orange);
        }

        /* Rou challenge title (blue) */
        .challenge-title.rou-theme {
            color: var(--secondary-blue);
        }

        .close-btn {
            background: rgba(55, 65, 81, 0.6);
            color: rgba(156, 163, 175, 0.8);
            border: 1px solid rgba(156, 163, 175, 0.4);
            padding: 8px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9em;
            font-weight: normal;
            margin-top: 20px;
            width: auto;
            max-width: 200px;
            margin-left: auto;
            margin-right: auto;
            display: block;
            transition: all 0.3s ease;
            opacity: 0.7;
        }

        .close-btn:hover {
            background: rgba(55, 65, 81, 0.8);
            color: rgba(156, 163, 175, 1);
            border-color: rgba(156, 163, 175, 0.6);
            opacity: 1;
            transform: none;
        }

        /* Piano Challenge Styles */
        .piano-instructions {
            background: rgba(255,107,53,0.1);
            border: 1px solid rgba(255,107,53,0.3);
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .notes-display {
            background: rgba(0,0,0,0.4);
            padding: 15px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 1.2em;
            text-align: center;
            margin: 15px 0;
            letter-spacing: 3px;
        }

        .treble-reference {
            background: rgba(0,0,0,0.3);
            padding: 10px;
            border-radius: 8px;
            font-size: 0.9em;
            margin-top: 15px;
        }

        /* Math Challenge Styles */
        .math-mission {
            background: rgba(69,183,209,0.1);
            border: 1px solid rgba(69,183,209,0.3);
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 15px;
        }

        .mission-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
        }

        .mission-number {
            background: rgba(69,183,209,0.3);
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }

        .mission-category {
            background: rgba(0,0,0,0.4);
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 0.8em;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .mission-question {
            font-size: 1.1em;
            line-height: 1.5;
            margin-bottom: 15px;
        }

        .answer-input {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .answer-field {
            padding: 10px;
            border: 2px solid rgba(69,183,209,0.3);
            border-radius: 8px;
            background: rgba(0,0,0,0.3);
            color: white;
            font-size: 1em;
            width: 100px;
        }

        .submit-answer {
            background: linear-gradient(135deg, #27ae60, #2ecc71);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
        }

        .submit-answer:hover {
            transform: translateY(-1px);
        }

        .answer-feedback {
            margin-top: 10px;
            padding: 10px;
            border-radius: 8px;
            font-weight: bold;
        }

        .answer-feedback.correct {
            background: rgba(39,174,96,0.2);
            color: #2ecc71;
        }

        .answer-feedback.incorrect {
            background: rgba(231,76,60,0.2);
            color: #e74c3c;
        }

        .mission-progress {
            text-align: center;
            margin-top: 20px;
            font-size: 0.9em;
            opacity: 0.8;
        }

        .complete-btn {
            background: linear-gradient(135deg, #27ae60, #2ecc71);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 12px;
            font-size: 1.1em;
            font-weight: bold;
            cursor: pointer;
            margin-top: 20px;
            display: none;
        }

        .complete-btn:hover {
            transform: translateY(-2px);
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .main-layout {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            .challenges-section {
                flex-direction: column;
                max-width: 100%;
                padding: 0 10px;
            }
            
            .room-content {
                margin: 10px;
                padding: 15px;
            }

            .room-header {
                max-width: 100%;
                padding: 15px;
            }

            .room-title {
                font-size: 1.6em;
                flex-direction: column;
                gap: 5px;
            }
        }

        /* Piano Challenge Modal */
        .piano-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.9);
            z-index: 1500;
            overflow-y: auto;
        }

        .piano-modal-content {
            max-width: 600px;
            margin: 5% auto;
            padding: 40px;
            background: rgba(31, 41, 55, 0.95);
            border: 3px solid var(--primary-green);
            border-radius: 20px;
            text-align: center;
            box-shadow: 0 0 30px rgba(34, 197, 94, 0.5);
            position: relative;
        }

        .piano-modal-header {
            font-family: 'Cinzel', serif;
            font-size: 2.2em;
            margin-bottom: 20px;
            color: var(--primary-green);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            font-weight: 600;
        }

        .piano-story-context {
            background: rgba(34, 197, 94, 0.15);
            border: 2px solid rgba(34, 197, 94, 0.3);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            font-style: italic;
            line-height: 1.6;
        }

        .piano-challenge-desc {
            background: rgba(249, 115, 22, 0.15);
            border: 2px solid rgba(249, 115, 22, 0.3);
            border-radius: 15px;
            padding: 15px;
            margin: 20px 0;
            font-weight: bold;
            color: var(--primary-orange);
        }

        .piano-instructions-modal {
            background: rgba(0,0,0,0.5);
            border-radius: 15px;
            padding: 25px;
            margin: 25px 0;
            text-align: left;
        }

        .piano-melody-display {
            background: rgba(34, 197, 94, 0.2);
            padding: 20px;
            border-radius: 10px;
            font-family: 'Courier New', monospace;
            font-size: 1.5em;
            text-align: center;
            margin: 20px 0;
            letter-spacing: 5px;
            color: var(--primary-green);
            font-weight: bold;
            border: 2px solid var(--primary-green);
        }

        .piano-complete-btn {
            background: linear-gradient(135deg, var(--primary-green), #16a34a);
            color: white;
            border: 2px solid var(--primary-green);
            padding: 15px 40px;
            border-radius: 12px;
            font-size: 1.2em;
            font-weight: bold;
            cursor: pointer;
            margin-top: 25px;
            transition: all 0.3s ease;
        }

        .piano-complete-btn:hover {
            background: linear-gradient(135deg, #16a34a, #15803d);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(34, 197, 94, 0.4);
        }

        .piano-close-btn {
            position: absolute;
            top: 15px;
            right: 20px;
            background: rgba(0,0,0,0.5);
            color: white;
            border: none;
            width: 35px;
            height: 35px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 1.2em;
        }

        .piano-close-btn:hover {
            background: rgba(0,0,0,0.8);
        }

        /* Math Question Modal */
        .math-question-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.9);
            z-index: 1500;
            overflow-y: auto;
        }

        .math-question-content {
            max-width: 600px;
            margin: 5% auto;
            padding: 40px;
            background: rgba(31, 41, 55, 0.95);
            border-radius: 20px;
            text-align: center;
            position: relative;
            border: 3px solid;
            box-shadow: 0 0 30px;
        }

        /* Wells math question content (green theme) */
        .math-question-content.wells-theme {
            border-color: var(--primary-green);
            box-shadow: 0 0 30px rgba(34, 197, 94, 0.5);
        }

        /* Rou math question content (blue theme) */
        .math-question-content.rou-theme {
            border-color: var(--secondary-blue);
            box-shadow: 0 0 30px rgba(59, 130, 246, 0.5);
        }

        .math-question-header {
            font-family: 'Cinzel', serif;
            font-size: 2em;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            font-weight: 600;
        }

        /* Wells math question header (green) */
        .math-question-header.wells-theme {
            color: var(--primary-green);
        }

        /* Rou math question header (blue) */
        .math-question-header.rou-theme {
            color: var(--secondary-blue);
        }

        .math-story-context {
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            font-style: italic;
            line-height: 1.6;
            font-size: 1.5em;
            background: rgba(34, 197, 94, 0.15);
            border: 2px solid;
        }

        /* Wells math story context (green theme) */
        .math-story-context.wells-theme {
            background: rgba(34, 197, 94, 0.15);
            border-color: rgba(34, 197, 94, 0.3);
        }

        /* Rou math story context (blue theme) */
        .math-story-context.rou-theme {
            background: rgba(59, 130, 246, 0.15);
            border-color: rgba(59, 130, 246, 0.3);
        }

        .math-problem-display {
            background: rgba(249, 115, 22, 0.15);
            border: 2px solid rgba(249, 115, 22, 0.3);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            font-size: 1.2em;
            line-height: 1.5;
        }

        .math-answer-btn {
            background: linear-gradient(135deg, var(--secondary-blue), #1d4ed8);
            color: white;
            border: 2px solid var(--secondary-blue);
            padding: 15px 40px;
            border-radius: 12px;
            font-size: 1.2em;
            font-weight: bold;
            cursor: pointer;
            margin: 10px;
            transition: all 0.3s ease;
        }

        .math-answer-btn:hover:not(:disabled) {
            background: linear-gradient(135deg, #1d4ed8, #1e40af);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(59, 130, 246, 0.4);
        }

        .math-answer-btn:disabled {
            background: linear-gradient(135deg, var(--gray-dark), var(--gray-medium));
            border-color: var(--gray-medium);
            cursor: not-allowed;
            opacity: 0.6;
        }

        .math-return-btn {
            background: linear-gradient(135deg, var(--gray-dark), var(--gray-medium));
            color: white;
            border: 2px solid var(--gray-medium);
            padding: 12px 30px;
            border-radius: 12px;
            font-size: 1em;
            cursor: pointer;
            margin: 10px;
            transition: all 0.3s ease;
        }

        .math-return-btn:hover {
            background: linear-gradient(135deg, var(--gray-medium), var(--gray-light));
            color: var(--gray-darker);
        }

        /* Number Input Modal */
        .number-input-modal {
            display: none;
            position: fixed;
            top: 75%;
            left: 50%;
            transform: translateX(-50%);
            width: auto;
            min-width: 320px;
            max-width: 400px;
            background: transparent;
            z-index: 1600;
        }

        .number-input-content {
            max-width: 400px;
            margin: 0 auto;
            padding: 20px;
            background: rgba(255, 255, 255, 0.98);
            border-radius: 20px;
            text-align: center;
            color: #333;
            border: 3px solid;
            box-shadow: 0 0 30px;
        }

        /* Wells number input content (green theme) */
        .number-input-content.wells-theme {
            border-color: var(--primary-green);
            box-shadow: 0 0 30px rgba(34, 197, 94, 0.5);
        }

        /* Rou number input content (blue theme) */
        .number-input-content.rou-theme {
            border-color: var(--secondary-blue);
            box-shadow: 0 0 30px rgba(59, 130, 246, 0.5);
        }

        .number-input-header {
            font-family: 'Cinzel', serif;
            font-size: 1.8em;
            margin-bottom: 20px;
            color: var(--gray-darker);
            font-weight: 600;
        }

        .number-question-text {
            font-size: 1em;
            color: var(--gray-dark);
            margin-bottom: 20px;
            line-height: 1.4;
        }

        .number-display {
            background: var(--gray-light);
            border: 2px solid var(--gray-medium);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            font-size: 2em;
            font-weight: bold;
            color: var(--gray-darker);
            min-height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .number-pad {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin: 20px 0;
        }

        .number-btn {
            color: white;
            padding: 15px;
            border-radius: 12px;
            font-size: 1.5em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.2s ease;
            border: 2px solid;
        }

        /* Wells number buttons (green theme) */
        .number-btn.wells-theme {
            background: linear-gradient(135deg, var(--primary-green), #16a34a);
            border-color: var(--primary-green);
        }

        .number-btn.wells-theme:hover {
            background: linear-gradient(135deg, #16a34a, #15803d);
            transform: translateY(-1px);
        }

        /* Rou number buttons (blue theme) */
        .number-btn.rou-theme {
            background: linear-gradient(135deg, var(--secondary-blue), #1d4ed8);
            border-color: var(--secondary-blue);
        }

        .number-btn.rou-theme:hover {
            background: linear-gradient(135deg, #1d4ed8, #1e40af);
            transform: translateY(-1px);
        }

        .number-zero {
            grid-column: 2;
        }

        .control-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 10px;
            margin-top: 20px;
        }

        .clear-btn {
            background: linear-gradient(135deg, var(--primary-orange), #ea580c);
            color: white;
            border: 2px solid var(--primary-orange);
            padding: 15px;
            border-radius: 12px;
            font-size: 1.1em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .clear-btn:hover {
            background: linear-gradient(135deg, #ea580c, #dc2626);
        }

        .backspace-btn {
            background: linear-gradient(135deg, #dc2626, #b91c1c);
            color: white;
            border: 2px solid #dc2626;
            padding: 15px;
            border-radius: 12px;
            font-size: 1.1em;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .backspace-btn:hover {
            background: linear-gradient(135deg, #b91c1c, #991b1b);
        }

        .submit-btn {
            background: linear-gradient(135deg, var(--gray-dark), var(--gray-medium));
            color: white;
            border: 2px solid var(--gray-dark);
            padding: 15px;
            border-radius: 12px;
            font-size: 1.1em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .submit-btn:hover {
            background: linear-gradient(135deg, var(--gray-medium), var(--gray-light));
            color: var(--gray-darker);
        }

        /* Logo Styles */
        .logo-container {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 15px;
            width: 100%;
            margin-bottom: 25px;
        }

        .main-logo {
            max-width: 350px;
            max-height: 140px;
            object-fit: contain;
            border-radius: 15px;
            box-shadow: 0 0 25px rgba(251, 191, 36, 0.3);
            border: 2px solid rgba(251, 191, 36, 0.4);
            transition: all 0.4s ease;
        }

        .background-art-container {
            flex: 1;
            width: 100%;
            max-width: 400px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.3);
        }

        .background-art {
            width: 100%;
            height: 400px;
            object-fit: contain;
            object-position: center;
            border-radius: 15px;
            transition: all 0.3s ease;
        }

        .background-art:hover {
            transform: scale(1.02);
        }

        .center-content:hover .main-logo {
            transform: scale(1.02);
            box-shadow: 0 0 35px rgba(251, 191, 36, 0.5);
            border-color: #fbbf24;
        }

        /* Loot Discovery Modal */
        .loot-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.95);
            z-index: 2000;
            overflow-y: auto;
        }

        .loot-modal-content {
            max-width: 500px;
            margin: 5% auto;
            padding: 0;
            background: rgba(20, 30, 40, 0.98);
            border: 4px solid var(--primary-green);
            border-radius: 20px;
            text-align: center;
            box-shadow: 0 0 40px rgba(34, 197, 94, 0.6);
            position: relative;
            overflow: hidden;
        }

        .loot-header {
            background: linear-gradient(135deg, rgba(34, 197, 94, 0.2), rgba(34, 197, 94, 0.1));
            padding: 25px;
            border-bottom: 2px solid rgba(34, 197, 94, 0.3);
        }

        .loot-title {
            font-family: 'Cinzel', serif;
            font-size: 2.2em;
            font-weight: 600;
            color: var(--primary-green);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }

        .loot-artwork-container {
            padding: 30px;
            background: linear-gradient(135deg, rgba(255,215,0,0.1), rgba(255,165,0,0.05));
        }

        .loot-artwork {
            width: 200px;
            height: 200px;
            object-fit: contain;
            border-radius: 15px;
            border: 3px solid rgba(255,215,0,0.4);
            background: rgba(255,255,255,0.05);
            padding: 10px;
            box-shadow: 0 0 20px rgba(255,215,0,0.3);
        }

        .loot-content {
            padding: 25px;
        }

        .loot-subtitle {
            font-family: 'Cinzel', serif;
            font-size: 1.8em;
            font-weight: 600;
            color: #ffd700;
            margin-bottom: 15px;
        }

        .loot-description {
            font-size: 1.1em;
            color: var(--gray-light);
            line-height: 1.6;
            margin-bottom: 25px;
        }

        .loot-rarity-box {
            background: linear-gradient(135deg, rgba(34, 197, 94, 0.15), rgba(34, 197, 94, 0.1));
            border: 2px solid rgba(34, 197, 94, 0.4);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
        }

        .loot-rarity-title {
            font-family: 'Cinzel', serif;
            font-size: 1.4em;
            font-weight: 600;
            color: var(--primary-green);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .loot-rarity-desc {
            font-size: 1em;
            color: var(--gray-light);
            line-height: 1.5;
        }

        .loot-continue-btn {
            background: linear-gradient(135deg, var(--primary-green), #16a34a);
            color: white;
            border: 2px solid var(--primary-green);
            padding: 15px 40px;
            border-radius: 12px;
            font-size: 1.2em;
            font-weight: bold;
            cursor: pointer;
            margin-top: 25px;
            transition: all 0.3s ease;
            width: 100%;
        }

        .loot-continue-btn:hover {
            background: linear-gradient(135deg, #16a34a, #15803d);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(34, 197, 94, 0.4);
        }

        /* Rune Collection Windows */
        .rune-collection {
            background: rgba(31, 41, 55, 0.95);
            border: 3px solid var(--primary-green);
            border-radius: 15px;
            padding: 20px;
            margin-top: 20px;
            box-shadow: 0 0 25px rgba(34, 197, 94, 0.3);
            transition: all 0.3s ease;
        }

        .rune-collection:hover {
            box-shadow: 0 0 30px rgba(34, 197, 94, 0.4);
        }

        .rune-collection-header {
            font-family: 'Almendra', serif;
            text-align: center;
            margin-bottom: 15px;
            font-size: 1.2em;
            font-weight: 700;
            color: var(--primary-green);
            border-bottom: 2px solid rgba(34, 197, 94, 0.3);
            padding-bottom: 10px;
        }

        .rune-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            grid-template-rows: repeat(5, 1fr);
            gap: 8px;
            padding: 10px;
        }

        .rune-slot {
            width: 45px;
            height: 60px;
            border: 2px solid var(--gray-medium);
            border-radius: 8px;
            background: rgba(0, 0, 0, 0.3);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-size: 0.7em;
            transition: all 0.3s ease;
            position: relative;
            cursor: pointer;
            text-align: center;
            padding: 3px;
        }

        .rune-slot .rune-emoji {
            font-size: 1.4em;
            margin-bottom: 2px;
        }

        .rune-slot .rune-name {
            font-size: 0.6em;
            line-height: 1;
            font-weight: bold;
        }

        /* Uncollected runes */
        .rune-slot.uncollected {
            border-color: var(--gray-dark);
            background: rgba(0, 0, 0, 0.2);
            opacity: 0.3;
            color: var(--gray-medium);
        }

        .rune-slot.uncollected .rune-emoji {
            filter: grayscale(100%) brightness(0.4);
        }

        /* Wells collected runes (orange/gold) */
        .wells-runes .rune-slot.collected {
            border-color: var(--primary-orange);
            background: rgba(249, 115, 22, 0.15);
            box-shadow: 0 0 12px rgba(249, 115, 22, 0.4);
            color: #fbbf24;
            opacity: 1;
        }

        .wells-runes .rune-slot.collected .rune-emoji {
            filter: none;
        }

        /* Rou collected runes (blue/cyan) */
        .rou-runes .rune-slot.collected {
            border-color: var(--secondary-blue);
            background: rgba(59, 130, 246, 0.15);
            box-shadow: 0 0 12px rgba(59, 130, 246, 0.4);
            color: #60a5fa;
            opacity: 1;
        }

        .rou-runes .rune-slot.collected .rune-emoji {
            filter: none;
        }

        /* Recently collected pulse animation */
        .rune-slot.recent {
            animation: recentPulse 2s ease-in-out infinite alternate;
        }

        .wells-runes .rune-slot.recent {
            animation: recentPulseOrange 2s ease-in-out infinite alternate;
        }

        .rou-runes .rune-slot.recent {
            animation: recentPulseBlue 2s ease-in-out infinite alternate;
        }

        @keyframes recentPulseOrange {
            from { 
                box-shadow: 0 0 12px rgba(249, 115, 22, 0.4);
                transform: scale(1);
            }
            to { 
                box-shadow: 0 0 20px rgba(249, 115, 22, 0.7);
                transform: scale(1.05);
            }
        }

        @keyframes recentPulseBlue {
            from { 
                box-shadow: 0 0 12px rgba(59, 130, 246, 0.4);
                transform: scale(1);
            }
            to { 
                box-shadow: 0 0 20px rgba(59, 130, 246, 0.7);
                transform: scale(1.05);
            }
        }

        .rune-slot:hover {
            transform: scale(1.1);
        }

        .rune-slot.collected:hover {
            filter: brightness(1.2);
        }

        /* Tooltip for rune descriptions - DISABLED */
        /*
        .rune-tooltip {
            position: absolute;
            bottom: 120%;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.9);
            color: white;
            padding: 5px 10px;
            border-radius: 5px;
            font-size: 0.8em;
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
            border: 1px solid var(--primary-green);
            z-index: 1000;
        }

        .rune-slot:hover .rune-tooltip {
            opacity: 1;
        }
        */

        /* Subtle Admin Controls */
        .admin-controls {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            pointer-events: none;
            z-index: 100;
        }

        .admin-btn {
            position: absolute;
            bottom: 15px;
            width: 70px;
            height: 28px;
            background: rgba(55, 65, 81, 0.4);
            border: 1px solid rgba(156, 163, 175, 0.3);
            border-radius: 6px;
            color: rgba(156, 163, 175, 0.6);
            font-size: 11px;
            cursor: pointer;
            opacity: 0.35;
            transition: all 0.2s ease;
            pointer-events: auto;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 500;
        }

        .admin-btn:hover {
            opacity: 0.8;
            background: rgba(55, 65, 81, 0.6);
            border-color: rgba(156, 163, 175, 0.5);
            color: rgba(156, 163, 175, 0.9);
        }

        .admin-reset {
            left: 15px;
        }

        .admin-intro {
            right: 15px;
        }

        /* Rune Reward Key Section */
        .rune-reward-key {
            margin-top: 30px;
            padding: 25px;
            background: rgba(31, 41, 55, 0.95);
            border: 3px solid var(--primary-green);
            border-radius: 20px;
            box-shadow: 0 0 25px rgba(34, 197, 94, 0.3);
            transition: all 0.3s ease;
        }

        .rune-reward-key:hover {
            box-shadow: 0 0 30px rgba(34, 197, 94, 0.4);
        }

        .reward-key-header {
            text-align: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid rgba(34, 197, 94, 0.3);
        }

        .reward-key-title {
            font-family: 'Cinzel', serif;
            font-size: 2em;
            font-weight: 600;
            color: var(--primary-green);
            margin-bottom: 8px;
        }

        .reward-key-subtitle {
            font-size: 1.1em;
            opacity: 0.8;
            color: var(--gray-light);
            font-style: italic;
        }

        .reward-key-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            max-width: 1320px;
            margin: 0 auto;
        }

        .reward-entry {
            background: rgba(0, 0, 0, 0.4);
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 15px;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        .reward-entry:hover {
            transform: translateY(-2px);
            border-color: rgba(34, 197, 94, 0.5);
            box-shadow: 0 6px 20px rgba(34, 197, 94, 0.2);
        }

        .reward-entry.completed {
            opacity: 0.6;
            border-color: var(--success-green);
            background: rgba(34, 197, 94, 0.1);
        }

        .reward-entry.completed::after {
            content: '‚úÖ';
            position: absolute;
            top: 8px;
            right: 8px;
            font-size: 1em;
        }

        .reward-day {
            font-family: 'Cinzel', serif;
            font-size: 1.3em;
            font-weight: 600;
            margin-bottom: 15px;
            color: #fbbf24;
            text-align: center;
        }

        .reward-runes {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
        }

        .reward-rune {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 10px;
            border-radius: 10px;
            transition: all 0.3s ease;
            min-width: 92px;
        }

        .reward-rune:hover {
            transform: scale(1.1);
        }

        /* Wells reward rune styling (orange theme) */
        .reward-rune.wells-reward {
            background: rgba(249, 115, 22, 0.15);
            border: 2px solid rgba(249, 115, 22, 0.3);
            box-shadow: 0 0 10px rgba(249, 115, 22, 0.2);
        }

        .reward-rune.wells-reward:hover {
            border-color: var(--primary-orange);
            box-shadow: 0 0 15px rgba(249, 115, 22, 0.4);
        }

        .reward-rune.wells-reward .rune-name {
            color: var(--primary-orange);
        }

        /* Rou reward rune styling (blue theme) */
        .reward-rune.rou-reward {
            background: rgba(59, 130, 246, 0.15);
            border: 2px solid rgba(59, 130, 246, 0.3);
            box-shadow: 0 0 10px rgba(59, 130, 246, 0.2);
        }

        .reward-rune.rou-reward:hover {
            border-color: var(--secondary-blue);
            box-shadow: 0 0 15px rgba(59, 130, 246, 0.4);
        }

        .reward-rune.rou-reward .rune-name {
            color: var(--secondary-blue);
        }

        .rune-icon {
            font-size: 2.2em;
            margin-bottom: 8px;
            display: block;
        }

        .rune-name {
            font-size: 0.9em;
            font-weight: 600;
            text-align: center;
            line-height: 1.2;
        }

        .reward-arrow {
            font-size: 1.8em;
            color: var(--primary-green);
            text-shadow: 0 0 10px rgba(34, 197, 94, 0.5);
            animation: pulse 2s ease-in-out infinite alternate;
        }

        @keyframes pulse {
            from { opacity: 0.7; transform: scale(1); }
            to { opacity: 1; transform: scale(1.1); }
        }

        .reward-description {
            font-size: 0.95em;
            opacity: 0.8;
            color: var(--gray-light);
            text-align: center;
            line-height: 1.4;
            font-style: italic;
        }

        /* Responsive design for reward key */
        @media (max-width: 768px) {
            .reward-key-grid {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            .reward-entry {
                padding: 15px;
            }
            
            .reward-runes {
                gap: 10px;
            }
            
            .rune-icon {
                font-size: 1.8em;
            }
        }

        /* Audio Help Button Styles */
        .audio-help-section {
            margin-top: 20px;
            text-align: center;
        }

        .audio-help-btn {
            background: linear-gradient(135deg, var(--primary-green), #16a34a);
            border: 2px solid var(--primary-green);
            color: white;
            padding: 15px 25px;
            border-radius: 15px;
            font-size: 1.1em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin: 0 auto;
            box-shadow: 0 0 15px rgba(34, 197, 94, 0.3);
            position: relative;
            overflow: hidden;
        }

        .audio-help-btn:hover {
            background: linear-gradient(135deg, #16a34a, #15803d);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(34, 197, 94, 0.5);
            border-color: #22c55e;
        }

        .audio-help-btn:active {
            transform: translateY(0);
            box-shadow: 0 4px 15px rgba(34, 197, 94, 0.4);
        }

        .audio-help-btn.playing {
            background: linear-gradient(135deg, var(--primary-orange), #ea580c);
            border-color: var(--primary-orange);
            animation: audioPlaying 2s ease-in-out infinite alternate;
        }

        .audio-help-btn.playing:hover {
            background: linear-gradient(135deg, #ea580c, #dc2626);
        }

        @keyframes audioPlaying {
            from { 
                box-shadow: 0 0 15px rgba(249, 115, 22, 0.4);
                transform: scale(1);
            }
            to { 
                box-shadow: 0 0 25px rgba(249, 115, 22, 0.7);
                transform: scale(1.02);
            }
        }

        .audio-icon {
            font-size: 1.3em;
            transition: all 0.3s ease;
        }

        .audio-help-btn.playing .audio-icon {
            animation: pulse 1s ease-in-out infinite alternate;
        }

        .audio-text {
            font-family: 'Cinzel', serif;
            font-weight: 600;
        }

        /* Responsive design for audio button */
        @media (max-width: 768px) {
            .audio-help-btn {
                padding: 12px 20px;
                font-size: 1em;
            }
            
            .audio-icon {
                font-size: 1.2em;
            }
        }

        /* Success Message Modal */
        .success-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.95);
            z-index: 2500;
            overflow-y: auto;
        }

        .success-modal-content {
            max-width: 500px;
            margin: 8% auto;
            padding: 0;
            background: linear-gradient(135deg, rgba(31, 41, 55, 0.98), rgba(17, 24, 39, 0.95));
            border-radius: 20px;
            text-align: center;
            box-shadow: 0 0 50px rgba(34, 197, 94, 0.8);
            position: relative;
            overflow: hidden;
            border: 4px solid var(--primary-green);
        }

        .success-modal-content.wells-theme {
            border-color: var(--primary-orange);
            box-shadow: 0 0 50px rgba(249, 115, 22, 0.8);
        }

        .success-modal-content.rou-theme {
            border-color: var(--secondary-blue);
            box-shadow: 0 0 50px rgba(59, 130, 246, 0.8);
        }

        .success-header {
            background: linear-gradient(135deg, rgba(34, 197, 94, 0.3), rgba(34, 197, 94, 0.1));
            padding: 25px;
            border-bottom: 2px solid rgba(34, 197, 94, 0.4);
        }

        .success-header.wells-theme {
            background: linear-gradient(135deg, rgba(249, 115, 22, 0.3), rgba(249, 115, 22, 0.1));
            border-bottom-color: rgba(249, 115, 22, 0.4);
        }

        .success-header.rou-theme {
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.3), rgba(59, 130, 246, 0.1));
            border-bottom-color: rgba(59, 130, 246, 0.4);
        }

        .success-icon {
            font-size: 4em;
            margin-bottom: 15px;
            display: block;
            filter: drop-shadow(0 0 20px rgba(255, 215, 0, 0.8));
            animation: successGlow 2s ease-in-out infinite alternate;
        }

        @keyframes successGlow {
            from { transform: scale(1); filter: drop-shadow(0 0 20px rgba(255, 215, 0, 0.8)); }
            to { transform: scale(1.05); filter: drop-shadow(0 0 30px rgba(255, 215, 0, 1)); }
        }

        .success-title {
            font-family: 'Cinzel', serif;
            font-size: 2.2em;
            font-weight: 600;
            color: var(--primary-green);
            margin-bottom: 10px;
            text-shadow: 0 0 20px rgba(34, 197, 94, 0.8);
        }

        .success-title.wells-theme {
            color: var(--primary-orange);
            text-shadow: 0 0 20px rgba(249, 115, 22, 0.8);
        }

        .success-title.rou-theme {
            color: var(--secondary-blue);
            text-shadow: 0 0 20px rgba(59, 130, 246, 0.8);
        }

        .success-content {
            padding: 30px;
        }

        .success-message {
            font-size: 1.2em;
            color: var(--gray-light);
            line-height: 1.6;
            margin-bottom: 25px;
            font-style: italic;
        }

        .success-continue-btn {
            background: linear-gradient(135deg, var(--primary-green), #16a34a);
            color: white;
            border: 2px solid var(--primary-green);
            padding: 15px 40px;
            border-radius: 12px;
            font-size: 1.2em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'Cinzel', serif;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .success-continue-btn.wells-theme {
            background: linear-gradient(135deg, var(--primary-orange), #ea580c);
            border-color: var(--primary-orange);
        }

        .success-continue-btn.rou-theme {
            background: linear-gradient(135deg, var(--secondary-blue), #1d4ed8);
            border-color: var(--secondary-blue);
        }

        .success-continue-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(34, 197, 94, 0.6);
        }

        .success-continue-btn.wells-theme:hover {
            box-shadow: 0 8px 25px rgba(249, 115, 22, 0.6);
        }

        .success-continue-btn.rou-theme:hover {
            box-shadow: 0 8px 25px rgba(59, 130, 246, 0.6);
        }

        /* Day Completion Modal */
        .day-completion-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.95);
            z-index: 2500;
            overflow-y: auto;
        }

        .day-completion-content {
            max-width: 450px;
            margin: 12% auto;
            padding: 0;
            background: linear-gradient(135deg, rgba(31, 41, 55, 0.98), rgba(17, 24, 39, 0.95));
            border-radius: 20px;
            text-align: center;
            box-shadow: 0 0 50px rgba(255, 215, 0, 0.8);
            position: relative;
            overflow: hidden;
            border: 4px solid #ffd700;
            animation: modalGlow 2s ease-in-out infinite alternate;
        }

        .day-completion-header {
            background: linear-gradient(135deg, rgba(255, 215, 0, 0.3), rgba(255, 215, 0, 0.1));
            padding: 20px;
            border-bottom: 3px solid rgba(255, 215, 0, 0.4);
        }

        .completion-icon {
            font-size: 3em;
            margin-bottom: 10px;
            display: block;
            animation: gentlePulse 2s ease-in-out infinite;
        }

        .completion-title {
            font-family: 'Cinzel', serif;
            font-size: 1.8em;
            font-weight: bold;
            color: #ffd700;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.7);
            margin: 0;
        }

        .day-completion-body {
            padding: 30px 25px;
        }

        .completion-location {
            font-size: 1.1em;
            color: #e5e7eb;
            margin-bottom: 20px;
            font-style: italic;
        }

        .completion-tasks {
            background: rgba(0, 0, 0, 0.3);
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 15px;
            margin: 20px 0;
            text-align: left;
        }

        .task-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 8px 0;
            font-size: 0.95em;
            color: #e5e7eb;
        }

        .task-check {
            font-size: 1.2em;
            filter: drop-shadow(0 0 5px rgba(34, 197, 94, 0.8));
        }

        .completion-rune {
            background: linear-gradient(135deg, rgba(34, 197, 94, 0.2), rgba(34, 197, 94, 0.1));
            border: 2px solid rgba(34, 197, 94, 0.4);
            border-radius: 12px;
            padding: 15px;
            margin: 15px 0;
            font-size: 0.95em;
        }

        .rune-discovery {
            text-align: center;
        }

        .rune-found-text {
            font-family: 'Cinzel', serif;
            font-size: 1.2em;
            color: var(--primary-green);
            margin-bottom: 10px;
        }

        .rune-display {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .rune-icon {
                font-size: 2em;
            filter: drop-shadow(0 0 10px rgba(34, 197, 94, 1));
        }

        .rune-name {
            font-size: 1.1em;
            color: #e5e7eb;
            font-weight: bold;
        }

        .day-completion-continue {
            background: linear-gradient(135deg, #ffd700, #ffed4e);
            color: #1f2937;
            border: 3px solid #ffd700;
            padding: 12px 30px;
            border-radius: 12px;
            font-size: 1.1em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'Cinzel', serif;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-top: 15px;
        }

        .day-completion-continue:hover {
            background: linear-gradient(135deg, #ffed4e, #fbbf24);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(255, 215, 0, 0.6);
        }

        /* Completion Confirmation Modal */
        .completion-confirm-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.95);
            z-index: 3000;
            overflow-y: auto;
        }

        .completion-confirm-content {
            max-width: 450px;
            margin: 12% auto;
            padding: 0;
            background: linear-gradient(135deg, rgba(31, 41, 55, 0.98), rgba(17, 24, 39, 0.95));
            border-radius: 20px;
            text-align: center;
            box-shadow: 0 0 50px rgba(168, 85, 247, 0.8);
            position: relative;
            overflow: hidden;
            border: 4px solid #a855f7;
            animation: modalGlow 2s ease-in-out infinite alternate;
        }

        .completion-confirm-header {
            background: linear-gradient(135deg, #a855f7, #7c3aed);
            padding: 20px;
            border-radius: 16px 16px 0 0;
            position: relative;
        }

        .completion-confirm-icon {
            font-size: 3em;
            margin-bottom: 10px;
            display: block;
            animation: gentlePulse 2s ease-in-out infinite;
        }

        .completion-confirm-title {
            font-family: 'Cinzel', serif;
            font-size: 1.8em;
            font-weight: bold;
            color: white;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.7);
            margin: 0;
        }

        .completion-confirm-body {
            padding: 30px 25px;
        }

        .completion-confirm-message {
            font-size: 1.1em;
            color: #e5e7eb;
            margin-bottom: 30px;
            line-height: 1.6;
        }

        .completion-confirm-buttons {
            display: flex;
                gap: 15px;
            justify-content: center;
        }

        .completion-confirm-btn {
            padding: 12px 25px;
            border: none;
            border-radius: 12px;
            font-family: 'Cinzel', serif;
            font-size: 1em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
            min-width: 100px;
        }

        .completion-confirm-yes {
            background: linear-gradient(135deg, var(--primary-green), #16a34a);
            color: white;
            box-shadow: 0 4px 15px rgba(34, 197, 94, 0.4);
        }

        .completion-confirm-yes:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(34, 197, 94, 0.6);
        }

        .completion-confirm-no {
            background: linear-gradient(135deg, #64748b, #475569);
            color: white;
            box-shadow: 0 4px 15px rgba(100, 116, 139, 0.4);
        }

        .completion-confirm-no:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(100, 116, 139, 0.6);
        }

        /* Rune Discovery Modal */
        .rune-discovery-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.95);
            z-index: 2600;
            overflow-y: auto;
            animation: fadeIn 0.3s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .rune-discovery-content {
            max-width: 500px;
            margin: 8% auto;
            padding: 0;
            background: linear-gradient(135deg, rgba(31, 41, 55, 0.98), rgba(17, 24, 39, 0.95));
            border-radius: 20px;
            text-align: center;
            box-shadow: 0 0 50px rgba(34, 197, 94, 0.8);
            position: relative;
            overflow: hidden;
            border: 4px solid var(--primary-green);
            animation: runeGlow 2s ease-in-out infinite alternate;
        }

        .rune-discovery-content.wells-theme {
            border-color: var(--primary-orange);
            box-shadow: 0 0 50px rgba(249, 115, 22, 0.8);
        }

        .rune-discovery-content.rou-theme {
            border-color: var(--secondary-blue);
            box-shadow: 0 0 50px rgba(59, 130, 246, 0.8);
        }

        @keyframes runeGlow {
            from { 
                box-shadow: 0 0 30px rgba(34, 197, 94, 0.6);
                transform: scale(1);
            }
            to { 
                box-shadow: 0 0 60px rgba(34, 197, 94, 1);
                transform: scale(1.02);
            }
        }

        .rune-discovery-header {
            background: linear-gradient(135deg, rgba(34, 197, 94, 0.3), rgba(34, 197, 94, 0.1));
            padding: 25px;
            border-bottom: 2px solid rgba(34, 197, 94, 0.4);
        }

        .rune-discovery-header.wells-theme {
            background: linear-gradient(135deg, rgba(249, 115, 22, 0.3), rgba(249, 115, 22, 0.1));
            border-bottom-color: rgba(249, 115, 22, 0.4);
        }

        .rune-discovery-header.rou-theme {
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.3), rgba(59, 130, 246, 0.1));
            border-bottom-color: rgba(59, 130, 246, 0.4);
        }

        .rune-discovery-icon {
            font-size: 3em;
            margin-bottom: 15px;
            display: block;
            filter: drop-shadow(0 0 20px rgba(255, 215, 0, 0.8));
            animation: sparkle 1.5s ease-in-out infinite alternate;
        }

        @keyframes sparkle {
            from { 
                transform: scale(1) rotate(0deg);
                filter: drop-shadow(0 0 20px rgba(255, 215, 0, 0.8));
            }
            to { 
                transform: scale(1.1) rotate(5deg);
                filter: drop-shadow(0 0 30px rgba(255, 215, 0, 1));
            }
        }

        .rune-discovery-title {
            font-family: 'Cinzel', serif;
            font-size: 2.2em;
            font-weight: 600;
            color: var(--primary-green);
            margin-bottom: 10px;
            text-shadow: 0 0 20px rgba(34, 197, 94, 0.8);
        }

        .rune-discovery-title.wells-theme {
            color: var(--primary-orange);
            text-shadow: 0 0 20px rgba(249, 115, 22, 0.8);
        }

        .rune-discovery-title.rou-theme {
            color: var(--secondary-blue);
            text-shadow: 0 0 20px rgba(59, 130, 246, 0.8);
        }

        .rune-discovery-body {
            padding: 30px;
        }

        .discovered-rune {
            background: rgba(0, 0, 0, 0.4);
            border: 3px solid var(--primary-green);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 25px;
            animation: runeReveal 0.8s ease-out;
        }

        .discovered-rune.wells-theme {
            border-color: var(--primary-orange);
            box-shadow: 0 0 25px rgba(249, 115, 22, 0.5);
        }

        .discovered-rune.rou-theme {
            border-color: var(--secondary-blue);
            box-shadow: 0 0 25px rgba(59, 130, 246, 0.5);
        }

        @keyframes runeReveal {
            from { 
                opacity: 0;
                transform: scale(0.8) translateY(20px);
            }
            to { 
                opacity: 1;
                transform: scale(1) translateY(0);
            }
        }

        .discovered-rune-emoji {
            font-size: 4em;
            display: block;
            margin-bottom: 15px;
            animation: runeFloat 3s ease-in-out infinite;
        }

        @keyframes runeFloat {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        .discovered-rune-name {
            font-family: 'Cinzel', serif;
            font-size: 1.8em;
            font-weight: 600;
            color: var(--primary-green);
            text-shadow: 0 0 15px rgba(34, 197, 94, 0.7);
        }

        .discovered-rune-name.wells-theme {
            color: var(--primary-orange);
            text-shadow: 0 0 15px rgba(249, 115, 22, 0.7);
        }

        .discovered-rune-name.rou-theme {
            color: var(--secondary-blue);
            text-shadow: 0 0 15px rgba(59, 130, 246, 0.7);
        }

        .rune-discovery-message {
            font-size: 1.2em;
            color: var(--gray-light);
            line-height: 1.6;
            margin-bottom: 25px;
            font-style: italic;
        }

        .rune-discovery-continue {
            background: linear-gradient(135deg, var(--primary-green), #16a34a);
            color: white;
            border: 2px solid var(--primary-green);
            padding: 15px 40px;
            border-radius: 12px;
            font-size: 1.2em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'Cinzel', serif;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .rune-discovery-continue.wells-theme {
            background: linear-gradient(135deg, var(--primary-orange), #ea580c);
            border-color: var(--primary-orange);
        }

        .rune-discovery-continue.rou-theme {
            background: linear-gradient(135deg, var(--secondary-blue), #1d4ed8);
            border-color: var(--secondary-blue);
        }

        .rune-discovery-continue:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(34, 197, 94, 0.6);
        }

        .rune-discovery-continue.wells-theme:hover {
            box-shadow: 0 8px 25px rgba(249, 115, 22, 0.6);
        }

        .rune-discovery-continue.rou-theme:hover {
            box-shadow: 0 8px 25px rgba(59, 130, 246, 0.6);
        }
    </style>
</head>
<body>
    <div class="game-container">
        <!-- Main Layout -->
        <div class="main-layout">
            <!-- Wells Player Card -->
            <div>
                <div class="player-card wells-card" onclick="openPlayerRoom('wells')">
                    <div class="avatar wells-avatar">
                        <img src="assets/avatars/wells_avatar.png" alt="Wells Avatar" class="avatar-image">
            </div>
                    <div class="current-room">üåÖ Dawnbreak Expanse</div>
                    <div class="day-info">Day 1 ‚Ä¢ Hall of Harmonies</div>
        </div>

                <!-- Wells Rune Collection -->
                <div class="rune-collection wells-runes">
                    <div class="rune-collection-header">Wells' Runes</div>
                    <div class="rune-grid" id="wellsRuneGrid">
                        <!-- Runes will be generated dynamically -->
                    </div>
                </div>
            </div>

            <!-- Center Content (Logo & Background Art) -->
            <div class="center-content">
                <div class="logo-container">
                    <img src="assets/lore/rune-bearers-logo.jpg" alt="Rune Bearers Logo" class="main-logo">
                </div>
                <div class="background-art-container">
                    <img src="assets/lore/rune_realm_split_sm.jpg" alt="Rune Realm" class="background-art">
                </div>
                </div>
                
            <!-- Rou Player Card -->
            <div>
                <div class="player-card rou-card" onclick="openPlayerRoom('rou')">
                    <div class="avatar rou-avatar">
                        <img src="assets/avatars/rou_avatar.png" alt="Rou Avatar" class="avatar-image">
                </div>
                    <div class="current-room">‚ùÑÔ∏è Crystal Glade</div>
                    <div class="day-info">Day 1 ‚Ä¢ Entry Cavern</div>
            </div>

                <!-- Rou Rune Collection -->
                <div class="rune-collection rou-runes">
                    <div class="rune-collection-header">Rou's Runes</div>
                    <div class="rune-grid" id="rouRuneGrid">
                        <!-- Runes will be generated dynamically -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Rune Reward Key Section -->
        <div class="rune-reward-key">
            <div class="reward-key-header">
                <div class="reward-key-title">üèÜ Rune Reward Key</div>
                <div class="reward-key-subtitle">Complete daily challenges to earn these powerful runes</div>
            </div>
            
            <div class="reward-key-grid">
                <!-- Ember Fang + Frost Fang -->
                <div class="reward-entry">
                    <div class="reward-runes">
                        <div class="reward-rune wells-reward">
                            <span class="rune-icon">üî•</span>
                            <span class="rune-name">Ember Fang</span>
                        </div>
                        <div class="reward-arrow">‚Üí</div>
                        <div class="reward-rune rou-reward">
                            <span class="rune-icon">‚ùÑÔ∏è</span>
                            <span class="rune-name">Frost Fang</span>
                        </div>
                    </div>
                    <div class="reward-description">üç¶ Ice cream treat</div>
        </div>

                <!-- Sky Feather + Mist Weaver -->
                <div class="reward-entry">
                    <div class="reward-runes">
                        <div class="reward-rune wells-reward">
                            <span class="rune-icon">ü™∂</span>
                            <span class="rune-name">Sky Feather</span>
            </div>
                        <div class="reward-arrow">‚Üí</div>
                        <div class="reward-rune rou-reward">
                            <span class="rune-icon">üå´Ô∏è</span>
                            <span class="rune-name">Mist Weaver</span>
                        </div>
                    </div>
                    <div class="reward-description">üéÆ Big Helmet Heroes game</div>
                </div>

                <!-- Iron Root + Stone Wing -->
                <div class="reward-entry">
                    <div class="reward-runes">
                        <div class="reward-rune wells-reward">
                            <span class="rune-icon">üåø</span>
                            <span class="rune-name">Iron Root</span>
                        </div>
                        <div class="reward-arrow">‚Üí</div>
                        <div class="reward-rune rou-reward">
                            <span class="rune-icon">ü™®</span>
                            <span class="rune-name">Stone Wing</span>
                        </div>
                    </div>
                    <div class="reward-description">üß± Lego kit + custom mini-figure</div>
                </div>

                <!-- Tide Pearl + River Scale -->
                <div class="reward-entry">
                    <div class="reward-runes">
                        <div class="reward-rune wells-reward">
                            <span class="rune-icon">üîÆ</span>
                            <span class="rune-name">Tide Pearl</span>
                        </div>
                        <div class="reward-arrow">‚Üí</div>
                        <div class="reward-rune rou-reward">
                            <span class="rune-icon">üêü</span>
                            <span class="rune-name">River Scale</span>
                        </div>
                    </div>
                    <div class="reward-description">üç≠ Popsicles at the pool</div>
                </div>

                <!-- Shadow Paw + Phantom Cloak -->
                <div class="reward-entry">
                    <div class="reward-runes">
                        <div class="reward-rune wells-reward">
                            <span class="rune-icon">üêæ</span>
                            <span class="rune-name">Shadow Paw</span>
                        </div>
                        <div class="reward-arrow">‚Üí</div>
                        <div class="reward-rune rou-reward">
                            <span class="rune-icon">üëª</span>
                            <span class="rune-name">Phantom Cloak</span>
                        </div>
                    </div>
                    <div class="reward-description">üïπÔ∏è Visit to arcade</div>
                </div>

                <!-- Thunder Eye + Storm Fang -->
                <div class="reward-entry">
                    <div class="reward-runes">
                        <div class="reward-rune wells-reward">
                            <span class="rune-icon">‚ö°</span>
                            <span class="rune-name">Thunder Eye</span>
                        </div>
                        <div class="reward-arrow">‚Üí</div>
                        <div class="reward-rune rou-reward">
                            <span class="rune-icon">‚ö°</span>
                            <span class="rune-name">Storm Fang</span>
                        </div>
                    </div>
                    <div class="reward-description">üì∫ 30 min extra screen time</div>
                </div>

                <!-- Solar Scale + Star Prism -->
                <div class="reward-entry">
                    <div class="reward-runes">
                        <div class="reward-rune wells-reward">
                            <span class="rune-icon">‚òÄÔ∏è</span>
                            <span class="rune-name">Solar Scale</span>
                        </div>
                        <div class="reward-arrow">‚Üí</div>
                        <div class="reward-rune rou-reward">
                            <span class="rune-icon">‚≠ê</span>
                            <span class="rune-name">Star Prism</span>
                        </div>
                    </div>
                    <div class="reward-description">üé¨ Choose next family movie</div>
                </div>

                <!-- Lunar Mirror + Shadow Lens -->
                <div class="reward-entry">
                    <div class="reward-runes">
                        <div class="reward-rune wells-reward">
                            <span class="rune-icon">üåô</span>
                            <span class="rune-name">Lunar Mirror</span>
                        </div>
                        <div class="reward-arrow">‚Üí</div>
                        <div class="reward-rune rou-reward">
                            <span class="rune-icon">üîç</span>
                            <span class="rune-name">Shadow Lens</span>
                        </div>
                    </div>
                    <div class="reward-description">üåô Stay-up-late pass</div>
                </div>

                <!-- Crystal Spine + Iron Bark -->
                <div class="reward-entry">
                    <div class="reward-runes">
                        <div class="reward-rune wells-reward">
                            <span class="rune-icon">üíé</span>
                            <span class="rune-name">Crystal Spine</span>
                        </div>
                        <div class="reward-arrow">‚Üí</div>
                        <div class="reward-rune rou-reward">
                            <span class="rune-icon">üå≥</span>
                            <span class="rune-name">Iron Bark</span>
                        </div>
                    </div>
                    <div class="reward-description">üìö Pick a new book</div>
                </div>

                <!-- Stormcaller Sigil + Frozen Bloom -->
                <div class="reward-entry">
                    <div class="reward-runes">
                        <div class="reward-rune wells-reward">
                            <span class="rune-icon">‚õàÔ∏è</span>
                            <span class="rune-name">Stormcaller Sigil</span>
                        </div>
                        <div class="reward-arrow">‚Üí</div>
                        <div class="reward-rune rou-reward">
                            <span class="rune-icon">üå∫</span>
                            <span class="rune-name">Frozen Bloom</span>
                        </div>
                    </div>
                    <div class="reward-description">‚õ≥ Mini-golf with Happy Grandpa</div>
                </div>

                <!-- Blazing Antler + Molten Seed -->
                <div class="reward-entry">
                    <div class="reward-runes">
                        <div class="reward-rune wells-reward">
                            <span class="rune-icon">üî•</span>
                            <span class="rune-name">Blazing Antler</span>
                        </div>
                        <div class="reward-arrow">‚Üí</div>
                        <div class="reward-rune rou-reward">
                            <span class="rune-icon">üå±</span>
                            <span class="rune-name">Molten Seed</span>
                        </div>
                    </div>
                    <div class="reward-description">üçï Build-your-own pizza night</div>
                </div>

                <!-- Whisper Branch + Thunder Fang -->
                <div class="reward-entry">
                    <div class="reward-runes">
                        <div class="reward-rune wells-reward">
                            <span class="rune-icon">üåø</span>
                            <span class="rune-name">Whisper Branch</span>
                        </div>
                        <div class="reward-arrow">‚Üí</div>
                        <div class="reward-rune rou-reward">
                            <span class="rune-icon">‚ö°</span>
                            <span class="rune-name">Thunder Fang</span>
                        </div>
                    </div>
                    <div class="reward-description">ü™ô Minecraft coins</div>
                </div>

                <!-- Molten Shard + Skyborn Leaf -->
                <div class="reward-entry">
                    <div class="reward-runes">
                        <div class="reward-rune wells-reward">
                            <span class="rune-icon">üî∂</span>
                            <span class="rune-name">Molten Shard</span>
                        </div>
                        <div class="reward-arrow">‚Üí</div>
                        <div class="reward-rune rou-reward">
                            <span class="rune-icon">üçÉ</span>
                            <span class="rune-name">Skyborn Leaf</span>
                        </div>
                    </div>
                    <div class="reward-description">üî´ Nerf war</div>
                </div>

                <!-- Windrunner Crest + Mooncap -->
                <div class="reward-entry">
                    <div class="reward-runes">
                        <div class="reward-rune wells-reward">
                            <span class="rune-icon">üå™Ô∏è</span>
                            <span class="rune-name">Windrunner Crest</span>
                        </div>
                        <div class="reward-arrow">‚Üí</div>
                        <div class="reward-rune rou-reward">
                            <span class="rune-icon">üçÑ</span>
                            <span class="rune-name">Mooncap</span>
                        </div>
                    </div>
                    <div class="reward-description">üéÆ Family video game session</div>
                </div>

                <!-- Glowcap + Glacier Heart -->
                <div class="reward-entry">
                    <div class="reward-runes">
                        <div class="reward-rune wells-reward">
                            <span class="rune-icon">üçÑ</span>
                            <span class="rune-name">Glowcap</span>
                        </div>
                        <div class="reward-arrow">‚Üí</div>
                        <div class="reward-rune rou-reward">
                            <span class="rune-icon">üíô</span>
                            <span class="rune-name">Glacier Heart</span>
                        </div>
                    </div>
                    <div class="reward-description">ü•û Breakfast choice pass</div>
                </div>

                <!-- Obsidian Heart + Moonfire Bloom -->
                <div class="reward-entry">
                    <div class="reward-runes">
                        <div class="reward-rune wells-reward">
                            <span class="rune-icon">üñ§</span>
                            <span class="rune-name">Obsidian Heart</span>
                        </div>
                        <div class="reward-arrow">‚Üí</div>
                        <div class="reward-rune rou-reward">
                            <span class="rune-icon">üåô</span>
                            <span class="rune-name">Moonfire Bloom</span>
                        </div>
                    </div>
                    <div class="reward-description">üç® Custom Ice Cream Sundae Party</div>
                </div>

                <!-- Sunfire Crest + Stormpetal Veil -->
                <div class="reward-entry">
                    <div class="reward-runes">
                        <div class="reward-rune wells-reward">
                            <span class="rune-icon">‚òÄÔ∏è</span>
                            <span class="rune-name">Sunfire Crest</span>
                        </div>
                        <div class="reward-arrow">‚Üí</div>
                        <div class="reward-rune rou-reward">
                            <span class="rune-icon">üå∏</span>
                            <span class="rune-name">Stormpetal Veil</span>
                        </div>
                    </div>
                    <div class="reward-description">üé≤ Board game night pick</div>
                </div>

                <!-- Zephyr Bloom + Ironclad Husk -->
                <div class="reward-entry">
                    <div class="reward-runes">
                        <div class="reward-rune wells-reward">
                            <span class="rune-icon">üå∏</span>
                            <span class="rune-name">Zephyr Bloom</span>
                        </div>
                        <div class="reward-arrow">‚Üí</div>
                        <div class="reward-rune rou-reward">
                            <span class="rune-icon">üõ°Ô∏è</span>
                            <span class="rune-name">Ironclad Husk</span>
                        </div>
                    </div>
                    <div class="reward-description">ü•ê Pangea Pastry Quest</div>
                </div>

                <!-- Deepstone Shell + Frostthorn Crown -->
                <div class="reward-entry">
                    <div class="reward-runes">
                        <div class="reward-rune wells-reward">
                            <span class="rune-icon">üêö</span>
                            <span class="rune-name">Deepstone Shell</span>
                        </div>
                        <div class="reward-arrow">‚Üí</div>
                        <div class="reward-rune rou-reward">
                            <span class="rune-icon">üëë</span>
                            <span class="rune-name">Frostthorn Crown</span>
                        </div>
                    </div>
                    <div class="reward-description">ü•û Breakfast for Dinner Choice</div>
                </div>

                <!-- Emberthorn Crown + Ember Seed -->
                <div class="reward-entry">
                    <div class="reward-runes">
                        <div class="reward-rune wells-reward">
                            <span class="rune-icon">üëë</span>
                            <span class="rune-name">Emberthorn Crown</span>
                        </div>
                        <div class="reward-arrow">‚Üí</div>
                        <div class="reward-rune rou-reward">
                            <span class="rune-icon">üî•</span>
                            <span class="rune-name">Ember Seed</span>
                        </div>
                    </div>
                    <div class="reward-description">üéØ Nerf target contest</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Room View Modal -->
    <div id="roomModal" class="room-modal">
        <div class="room-content">
            
            <!-- Room Header -->
            <div class="room-header">
                <div class="room-title">
                    <span id="roomIcon">üåÖ</span>
                    <span id="roomName">Dawnbreak Expanse</span>
                </div>
                <div class="room-subtitle" id="roomSubtitle">Hall of Harmonies</div>
            </div>
            
            <!-- Room Artwork -->
            <img id="roomArtwork" class="room-artwork" src="assets/rooms/DawnbreakExpanse/DawnbreakExpanse_LockedDoor_20250601_day01.png" alt="Room Artwork">

            <!-- Story Section -->
            <div class="story-section" id="storyText">
                The golden sun rises through the sandstone arches. Ancient sun glyphs glow across the stone floor. The Rune Gate remains sealed. Five sun pillars must be activated to open the path.
            </div>
            
            <!-- Challenge Buttons -->
            <div class="challenges-section">
                <button id="irlChallengeBtn" class="challenge-btn irl-challenge-btn" onclick="startIRLChallenge()">
                    üéµ Begin Harmony Ritual
                </button>
                <button id="mathChallengeBtn" class="challenge-btn math-challenge-btn" onclick="startMathChallenge()" disabled>
                    üîÆ Solve Ancient Puzzles
                </button>
            </div>
            
            <!-- IRL Challenge Content -->
            <div id="irlChallengeContent" class="challenge-content">
                <div class="challenge-header">
                    <div class="challenge-icon">üéµ</div>
                    <div class="challenge-title">Harmony Ritual Available</div>
                </div>

                <div style="text-align: center; padding: 40px; opacity: 0.7;">
                    <p>Click "Begin Harmony Ritual" above to start your melodic quest!</p>
                </div>
            </div>
            
            <!-- Math Challenge Content -->
            <div id="mathChallengeContent" class="challenge-content">
                <div class="challenge-header">
                    <div class="challenge-icon">üîÆ</div>
                    <div class="challenge-title">Ancient Puzzles</div>
                </div>
            
                <!-- Mission Buttons -->
                <div style="display: flex; flex-direction: column; gap: 15px; margin: 20px 0;" id="mathMissionButtons">
                    <!-- Dynamic mission buttons will be generated here -->
                </div>

                <div class="mission-progress" id="mathProgress">Puzzle 1 of 3</div>
                <button class="complete-btn" id="completeMathBtn" onclick="completeMathChallenge()" style="display: none;">üéâ Complete Day 1 Challenges</button>
            </div>

            <!-- Return to Main Menu Button -->
            <button class="close-btn" onclick="closePlayerRoom()">Return to Main Menu</button>
        </div>
    </div>

    <!-- Piano Challenge Modal -->
    <div id="pianoModal" class="piano-modal">
        <div class="piano-modal-content">
            <button class="piano-close-btn" onclick="closePianoModal()">√ó</button>
            
            <div class="piano-modal-header">
                üéµ Harmony Ritual!
            </div>
            
            <div class="piano-story-context">
                The ancient Hall of Harmonies pulses with mystical energy. Wells approaches the enchanted harmonic altar at the chamber's heart. The magical keys glow softly, waiting for the correct melody to unlock the first sun pillar. Legend speaks of a simple tune that resonates with the hall's magical frequencies.
            </div>
            
            <div class="piano-challenge-desc">
                ‚ú® Ritual Objective ‚ú®<br>
                Perform the Harmony Melody to activate the first sun pillar and begin opening the sealed Rune Gate!
            </div>
            
            <div class="piano-instructions-modal">
                <h3 style="color: #4ecdc4; margin-bottom: 15px; text-align: center;">üéµ The Harmony Melody</h3>
                
                <div class="piano-melody-display">
                    C ‚Äì E ‚Äì G ‚Äì E ‚Äì C
                </div>
                
                <h4 style="color: #ffd700; margin-bottom: 10px;">Ritual Instructions:</h4>
                <ul style="margin: 15px 0; padding-left: 20px; line-height: 1.6;">
                    <li>Play this melody clearly and evenly on the harmonic altar</li>
                    <li>Repeat the melody 3 times in total</li>
                    <li>Start slowly, then increase your speed as you become more comfortable</li>
                    <li>Focus on the magical energy flowing through each note</li>
                </ul>
                
                <div style="background: rgba(78,205,196,0.1); padding: 15px; border-radius: 8px; margin-top: 20px;">
                    <strong style="color: #4ecdc4;">Harmonic Key Reference:</strong><br>
                    ‚Ä¢ C4: Middle Harmony (one ledger line below staff)<br>
                    ‚Ä¢ E4: Foundation Tone (bottom line of treble staff)<br>
                    ‚Ä¢ G4: Rising Harmony (second line from bottom of treble staff)
                </div>
            </div>
            
            <button class="piano-complete-btn" onclick="completePianoChallenge()">üåü I've Performed the Harmony Ritual!</button>
        </div>
    </div>

    <!-- Math Question Modal -->
    <div id="mathQuestionModal" class="math-question-modal">
        <div class="math-question-content">
            <div class="math-question-header" id="mathQuestionTitle">
                üßÆ Geometry Challenge
            </div>
            
            <div class="math-story-context" id="mathStoryContext">
                Wells examines the ancient sun pillars carefully. Each pillar bears a different geometric symbol carved deep into the sandstone. The Triangle Pillar stands proud with three sharp edges, the Square Pillar displays four equal sides, and the Pentagon Pillar shows five perfect angles. To unlock their combined power, Wells must calculate their total mystical sides.
            </div>
            
            <div class="math-problem-display" id="mathProblemText">
                Each sun pillar is marked by a different shape: Triangle, Square, Pentagon.<br>
                <strong>Mystery:</strong> How many total sides across all three pillars?
            </div>
            
            <button class="math-answer-btn" onclick="openNumberInput()">Answer Question</button>
            <button class="math-return-btn" onclick="closeMathQuestion()">Return to Room</button>
        </div>
    </div>

    <!-- Number Input Modal -->
    <div id="numberInputModal" class="number-input-modal">
        <div class="number-input-content">
            <!-- Removed title and question text - story visible in background -->
            
            <div class="number-display" id="numberDisplay">0</div>
            
            <div class="number-pad">
                <button class="number-btn" onclick="addNumber(1)">1</button>
                <button class="number-btn" onclick="addNumber(2)">2</button>
                <button class="number-btn" onclick="addNumber(3)">3</button>
                <button class="number-btn" onclick="addNumber(4)">4</button>
                <button class="number-btn" onclick="addNumber(5)">5</button>
                <button class="number-btn" onclick="addNumber(6)">6</button>
                <button class="number-btn" onclick="addNumber(7)">7</button>
                <button class="number-btn" onclick="addNumber(8)">8</button>
                <button class="number-btn" onclick="addNumber(9)">9</button>
                <button class="number-btn number-zero" onclick="addNumber(0)">0</button>
            </div>
            
            <div class="control-buttons">
                <button class="clear-btn" onclick="clearNumber()">Clear</button>
                <button class="backspace-btn" onclick="backspaceNumber()">üîô</button>
                <button class="submit-btn" onclick="submitNumber()">Submit</button>
            </div>
        </div>
    </div>

    <!-- Loot Discovery Modal -->
    <div id="lootModal" class="loot-modal">
        <div class="loot-modal-content">
            <div class="loot-header">
                <div class="loot-title">
                    üíé Treasure Discovered!
                </div>
            </div>
            
            <div class="loot-artwork-container">
                <img id="lootArtwork" class="loot-artwork" src="assets/loot/alien-robot-tiny-loot.png" alt="Loot Discovery">
            </div>
            
            <div class="loot-content">
                <div class="loot-subtitle" id="lootSubtitle">Tiny Loot Found!</div>
                
                <div class="loot-description" id="lootDescription">
                    Hidden within the ancient Hall of Harmonies, you've discovered valuable treasure!
                </div>
                
                <div class="loot-rarity-box">
                    <div class="loot-rarity-title">
                        ‚ú® Rare Discovery! ‚ú®
                    </div>
                    <div class="loot-rarity-desc">
                        Loot drops are uncommon rewards for exceptional puzzle solving!
                    </div>
                </div>
                
                <button class="loot-continue-btn" onclick="closeLootModal()">
                    Continue Adventure ‚Üí
                </button>
            </div>
        </div>
    </div>

    <!-- Success Message Modal -->
    <div id="successModal" class="success-modal">
        <div class="success-modal-content" id="successModalContent">
            <div class="success-header" id="successHeader">
                <span class="success-icon" id="successIcon">‚ú®</span>
                <div class="success-title" id="successTitle">Success!</div>
            </div>
            
            <div class="success-content">
                <div class="success-message" id="successMessage">
                    Great work! You've solved this challenge.
                </div>
                
                <button class="success-continue-btn" id="successContinueBtn" onclick="closeSuccessModal()">
                    Continue Quest
                </button>
            </div>
        </div>
    </div>

    <!-- Rune Discovery Modal -->
    <div id="runeDiscoveryModal" class="rune-discovery-modal">
        <div class="rune-discovery-content" id="runeDiscoveryContent">
            <div class="rune-discovery-header" id="runeDiscoveryHeader">
                <span class="rune-discovery-icon">‚ú®</span>
                <div class="rune-discovery-title">Rune Discovered!</div>
            </div>
            
            <div class="rune-discovery-body">
                <div class="discovered-rune">
                    <span class="discovered-rune-emoji" id="discoveredRuneEmoji">üíé</span>
                    <div class="discovered-rune-name" id="discoveredRuneName">Frost Fang</div>
                </div>
                
                <div class="rune-discovery-message">
                    This powerful rune has been added to your collection!
                </div>
                
                <button class="rune-discovery-continue" id="runeDiscoveryContinue" onclick="closeRuneDiscoveryModal()">
                    Continue Adventure ‚Üí
                </button>
            </div>
        </div>
    </div>

    <!-- Day Completion Modal -->
    <div id="dayCompletionModal" class="day-completion-modal">
        <div class="day-completion-content">
            <div class="day-completion-header" id="dayCompletionHeader">
                <span class="completion-icon">üëë</span>
                <div class="completion-title" id="dayCompletionTitle">Quest Complete!</div>
            </div>
            
            <div class="day-completion-body">
                <div class="completion-location" id="dayCompletionLocation">Mystical Realm</div>
                
                <div class="completion-tasks" id="dayCompletionTasks">
                    <!-- Task list will be populated by JavaScript -->
                </div>
                
                <div class="completion-rune" id="dayCompletionRune">
                    <!-- Rune discovery will be populated by JavaScript -->
                </div>
                
                <button class="day-completion-continue" id="dayCompletionContinue" onclick="closeDayCompletionModal()">
                    Return to Main Menu
                </button>
            </div>
        </div>
    </div>

    <div class="admin-controls">
        <button class="admin-btn admin-reset" onclick="resetGameState()" title="Reset Game State">üîÑ</button>
        <button class="admin-btn admin-intro" onclick="window.location.href='splash.html'" title="Return to Intro">üìπ</button>
    </div>

    <!-- Completion Confirmation Modal -->
    <div id="completionConfirmModal" class="completion-confirm-modal">
        <div class="completion-confirm-content">
            <div class="completion-confirm-header">
                <span class="completion-confirm-icon">üèÜ</span>
                <div class="completion-confirm-title">Complete Day?</div>
            </div>
            
            <div class="completion-confirm-body">
                <div class="completion-confirm-message" id="completionConfirmMessage">
                    All Crystal Mysteries solved! Ready to complete your quest for today?
                </div>
                
                <div class="completion-confirm-buttons">
                    <button class="completion-confirm-btn completion-confirm-no" onclick="closeCompletionConfirm()">
                        Not Yet
                    </button>
                    <button class="completion-confirm-btn completion-confirm-yes" onclick="confirmCompletion()">
                        Complete!
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Predefined Rune Collections - OFFICIAL SCHEDULE
        const runeCollections = {
            wells: [
                { emoji: 'üî•', name: 'Ember Fang', id: 'ember-fang' },
                { emoji: 'ü™∂', name: 'Sky Feather', id: 'sky-feather' },
                { emoji: 'üåø', name: 'Iron Root', id: 'iron-root' },
                { emoji: 'üîÆ', name: 'Tide Pearl', id: 'tide-pearl' },
                { emoji: 'üêæ', name: 'Shadow Paw', id: 'shadow-paw' },
                { emoji: '‚ö°', name: 'Thunder Eye', id: 'thunder-eye' },
                { emoji: '‚òÄÔ∏è', name: 'Solar Scale', id: 'solar-scale' },
                { emoji: 'üåô', name: 'Lunar Mirror', id: 'lunar-mirror' },
                { emoji: 'üíé', name: 'Crystal Spine', id: 'crystal-spine' },
                { emoji: '‚õàÔ∏è', name: 'Stormcaller Sigil', id: 'stormcaller-sigil' },
                { emoji: 'üî•', name: 'Blazing Antler', id: 'blazing-antler' },
                { emoji: 'üåø', name: 'Whisper Branch', id: 'whisper-branch' },
                { emoji: 'üî∂', name: 'Molten Shard', id: 'molten-shard' },
                { emoji: 'üå™Ô∏è', name: 'Windrunner Crest', id: 'windrunner-crest' },
                { emoji: 'üçÑ', name: 'Glowcap', id: 'glowcap' },
                { emoji: 'üñ§', name: 'Obsidian Heart', id: 'obsidian-heart' },
                { emoji: '‚òÄÔ∏è', name: 'Sunfire Crest', id: 'sunfire-crest' },
                { emoji: 'üå∏', name: 'Zephyr Bloom', id: 'zephyr-bloom' },
                { emoji: 'üêö', name: 'Deepstone Shell', id: 'deepstone-shell' },
                { emoji: 'üëë', name: 'Emberthorn Crown', id: 'emberthorn-crown' }
            ],
            rou: [
                { emoji: '‚ùÑÔ∏è', name: 'Frost Fang', id: 'frost-fang' },
                { emoji: 'üå´Ô∏è', name: 'Mist Weaver', id: 'mist-weaver' },
                { emoji: 'ü™®', name: 'Stone Wing', id: 'stone-wing' },
                { emoji: 'üêü', name: 'River Scale', id: 'river-scale' },
                { emoji: 'üëª', name: 'Phantom Cloak', id: 'phantom-cloak' },
                { emoji: '‚ö°', name: 'Storm Fang', id: 'storm-fang' },
                { emoji: '‚≠ê', name: 'Star Prism', id: 'star-prism' },
                { emoji: 'üîç', name: 'Shadow Lens', id: 'shadow-lens' },
                { emoji: 'üå≥', name: 'Iron Bark', id: 'iron-bark' },
                { emoji: 'üå∫', name: 'Frozen Bloom', id: 'frozen-bloom' },
                { emoji: 'üå±', name: 'Molten Seed', id: 'molten-seed' },
                { emoji: '‚ö°', name: 'Thunder Fang', id: 'thunder-fang' },
                { emoji: 'üçÉ', name: 'Skyborn Leaf', id: 'skyborn-leaf' },
                { emoji: 'üçÑ', name: 'Mooncap', id: 'mooncap' },
                { emoji: 'üíô', name: 'Glacier Heart', id: 'glacier-heart' },
                { emoji: 'üåô', name: 'Moonfire Bloom', id: 'moonfire-bloom' },
                { emoji: 'üå∏', name: 'Stormpetal Veil', id: 'stormpetal-veil' },
                { emoji: 'üõ°Ô∏è', name: 'Ironclad Husk', id: 'ironclad-husk' },
                { emoji: 'üëë', name: 'Frostthorn Crown', id: 'frostthorn-crown' },
                { emoji: 'üî•', name: 'Ember Seed', id: 'ember-seed' }
            ]
        };

        // Game State Management
        let gameState = {
            wells: {
                currentDay: 1,
                currentRealm: 'Dawnbreak Expanse',
                irlCompleted: false,
                mathCompleted: false,
                mathProgress: 0, // 0-3 missions completed
                completedDays: [],
                collectedRunes: [] // Will be populated based on official schedule
                },
                rou: {
                currentDay: 1,
                currentRealm: 'Crystal Glade',
                irlCompleted: false,
                mathCompleted: false,
                mathProgress: 0,
                completedDays: [],
                collectedRunes: [] // Will be populated based on official schedule
            }
        };

        // Math questions data - DEPRECATED: Now using gameContent.player.dayX.mathChallenge.missions
        /*
        const mathQuestions = {
            1: {
                title: '‚≠ê Sacred Geometry Challenge',
                story: 'Wells examines the ancient sun pillars carefully. Each pillar bears a different geometric symbol carved deep into the sandstone. The Triangle Pillar stands proud with three sharp edges, the Square Pillar displays four equal sides, and the Pentagon Pillar shows five perfect angles. To unlock their combined power, Wells must calculate their total mystical sides.',
                problem: 'Each sun pillar is marked by a different shape: Triangle, Square, Pentagon.<br><strong>Mystery:</strong> How many total sides across all three pillars?',
                answer: 12
            },
            2: {
                title: 'üíé Crystal Power Challenge',
                story: 'Deep within each sun pillar, Wells discovers glowing crystal chambers. Ten magnificent pillars stretch toward the sky, each one pulsing with exactly ten radiant sun crystals. The crystals hum with magical energy, their combined power needed to unlock the ancient Rune Gate. Wells must calculate the total crystal power.',
                problem: 'Each of the 10 sun pillars holds 10 sun crystals.<br><strong>Mystery:</strong> How many crystals power the Rune Gate?',
                answer: 100
            },
            3: {
                title: 'üèõÔ∏è Treasure Distribution Challenge',
                story: 'Behind the largest sun pillar, Wells discovers a hidden treasure chamber filled with 1000 gleaming sun coins! But Wells remembers the ancient law of the Rune Guild - treasure must be shared equally among all adventurers. He must divide the coins between himself, his companion Ferrin, and three brave Rune Guild Apprentices who aided their quest.',
                problem: 'Behind one pillar, Wells finds 1000 sun coins.<br>He shares them equally with Ferrin and 3 Rune Guild Apprentices.<br><strong>Mystery:</strong> How many coins does each receive?',
                answer: 200
            }
        };
        */

        let currentQuestion = 1;
        let currentInput = '0';

        // Content Management System
        const gameContent = {
            wells: {
                day1: {
                    realm: 'Dawnbreak Expanse',
                    room: 'Hall of Harmonies',
                    icon: 'üåÖ',
                    artwork: 'assets/rooms/DawnbreakExpanse/DawnbreakExpanse_LockedDoor_20250601_day01.png',
                    story: 'The golden sun rises through the sandstone arches. Ancient sun glyphs glow across the stone floor. The Rune Gate remains sealed. Five sun pillars must be activated to open the path.',
                    baseRune: null, // No rune awarded on Day 1
                    runeIcon: null,
                    irlChallenge: {
                        title: 'Wells Day One Piano Melody',
                        icon: 'üéπ',
                        type: 'piano',
                        content: {
                            notes: 'C ‚Äì E ‚Äì G ‚Äì E ‚Äì C',
                            instructions: [
                                'Play this melody clearly and evenly',
                                'Repeat the melody 3 times in total',
                                'Start slowly, then increase your speed as you become more comfortable'
                            ],
                            reference: [
                                'C4: Middle C (one ledger line below staff)',
                                'E4: Bottom line of treble staff',
                                'G4: Second line from bottom of treble staff'
                            ]
                        }
                    },
                    mathChallenge: {
                        title: 'Math Missions',
                        icon: 'üßÆ',
                        missions: [
                            {
                                category: 'Geometry',
                                title: '‚≠ê Sacred Geometry Challenge',
                                story: 'Wells examines the ancient sun pillars carefully. Each pillar bears a different geometric symbol carved deep into the sandstone. The Triangle Pillar stands proud with three sharp edges, the Square Pillar displays four equal sides, and the Pentagon Pillar shows five perfect angles. To unlock their combined power, Wells must calculate their total mystical sides.',
                                question: 'Each sun pillar is marked by a different shape: Triangle, Square, Pentagon.<br><strong>Mystery:</strong> How many total sides across all three pillars?',
                                answer: 12
                            },
                            {
                                category: 'Multiplication',
                                title: 'üíé Crystal Power Challenge',
                                story: 'Deep within each sun pillar, Wells discovers glowing crystal chambers. Ten magnificent pillars stretch toward the sky, each one pulsing with exactly ten radiant sun crystals. The crystals hum with magical energy, their combined power needed to unlock the ancient Rune Gate. Wells must calculate the total crystal power.',
                                question: 'Each of the 10 sun pillars holds 10 sun crystals.<br><strong>Mystery:</strong> How many crystals power the Rune Gate?',
                                answer: 100
                            },
                            {
                                category: 'Division',
                                title: 'üèõÔ∏è Treasure Distribution Challenge',
                                story: 'Behind the largest sun pillar, Wells discovers a hidden treasure chamber filled with 1000 gleaming sun coins! But Wells remembers the ancient law of the Rune Guild - treasure must be shared equally among all adventurers. He must divide the coins between himself, his companion Ferrin, and three brave Rune Guild Apprentices who aided their quest.',
                                question: 'Behind one pillar, Wells finds 1000 sun coins.<br>He shares them equally with Ferrin and 3 Rune Guild Apprentices.<br><strong>Mystery:</strong> How many coins does each receive?',
                                answer: 200
                            }
                        ]
                    }
                }
            },
            rou: {
                day1: {
                    realm: 'Crystal Glade',
                    room: 'Entry Cavern',
                    icon: '‚ùÑÔ∏è',
                    artwork: 'assets/rooms/CrystalGlade/CrystalGlade_FrostHollow_Rou_Day1_768.jpg',
                    story: 'You step into the Crystal Glade. The cave floor sparkles with blue crystals. A tall ice gate blocks your path. The gate has three small slots that need crystals to open. Ice on the walls makes the floor slippery. Three wooden crates hold magic orbs that can help you. A frozen chest sits behind the gate, waiting for you to open it once the gate is free. The room feels cold and magical.',
                    baseRune: 'Frost Fang', // Day 1 rune per official schedule
                    runeIcon: '‚ùÑÔ∏è',
                    irlChallenge: {
                        title: 'No IRL Challenge',
                        icon: 'üö´',
                        type: 'none',
                        content: {
                            description: 'Math-only day'
                        }
                    },
                    mathChallenge: {
                        title: 'Crystal Mysteries',
                        icon: 'üßÆ',
                        missions: [
                            {
                                category: 'Addition',
                                title: 'üíé Crystal Collection Challenge',
                                story: 'You step carefully across the sparkling cave floor. Beautiful blue crystals catch the light from above. You spot 14 blue crystals scattered on the ground, glinting like tiny stars. As you explore further, you reach under a large, smooth rock and discover 9 more hidden crystals nestled in the shadows.',
                                question: 'You see 14 blue crystals on the ground. You reach under a rock and find 9 more crystals.<br><strong>Mystery:</strong> How many crystals do you have now?',
                                answer: 23
                            },
                            {
                                category: 'Subtraction',
                                title: 'üßä Frost Gem Adventure',
                                story: 'Your magical pouch holds 18 precious frost gems, each one shimmering with icy blue light. The cavern floor is covered in slippery ice that makes walking tricky. Suddenly, your foot slips on a patch of smooth ice! As you try to keep your balance, 7 of your beautiful frost gems tumble out and disappear into a dark, deep hole in the ground.',
                                question: 'You carry 18 frost gems as you step on icy stones. You slip, and 7 frost gems tumble down into a dark hole.<br><strong>Mystery:</strong> How many frost gems do you still have?',
                                answer: 11
                            },
                            {
                                category: 'Multiplication',
                                title: 'üéÅ Magic Orb Discovery',
                                story: 'Against the cavern wall, you notice 3 sturdy wooden crates stacked carefully on top of each other. Each crate is bound with silver rope and glows with a soft, magical light. You peek inside the first crate and count 4 glowing magic orbs. The second crate also holds 4 magic orbs, and so does the third crate. These orbs might be the key to opening the ice gate!',
                                question: 'You notice 3 wooden crates in the cave. Each crate holds 4 magic orbs inside.<br><strong>Mystery:</strong> How many magic orbs are there in all the crates?',
                                answer: 12
                            }
                        ]
                    }
                }
            }
        };

        // Rune Collection System
        function addRuneToCollection(player, runeName) {
            const playerData = gameState[player];
            
            // Check if rune already exists
            if (playerData.collectedRunes.includes(runeName)) return;
            
            // Add rune to collection
            playerData.collectedRunes.push(runeName);
            
            // Update display
            updateRuneDisplay(player);
            
            // Save game state
            saveGameState();
        }

        function updateRuneDisplay(player) {
            console.log(`Updating rune display for ${player}`);
            
            const playerData = gameState[player];
            console.log('Player data:', playerData);
            
            const gridId = player === 'wells' ? 'wellsRuneGrid' : 'rouRuneGrid';
            const grid = document.getElementById(gridId);
            console.log('Grid element:', grid);
            
            const runes = runeCollections[player];
            console.log('Runes for player:', runes);
            
            if (!grid) {
                console.error(`Grid element not found: ${gridId}`);
                return;
            }
            
            if (!runes) {
                console.error(`Runes not found for player: ${player}`);
                return;
            }
            
            // Generate all rune slots
            grid.innerHTML = '';
            runes.forEach((rune, index) => {
                const isCollected = playerData.collectedRunes.includes(rune.name);
                const slot = document.createElement('div');
                slot.className = `rune-slot ${isCollected ? 'collected' : 'uncollected'}`;
                slot.innerHTML = `
                    <div class="rune-emoji">${rune.emoji}</div>
                    <div class="rune-name">${rune.name}</div>
                `;
                grid.appendChild(slot);
            });
            
            console.log(`Generated ${runes.length} rune slots for ${player}`);
        }

        let currentPlayer = null;

        // Initialize game
        function initGame() {
            // Auto-save game state periodically
            setInterval(saveGameState, 30000); // Save every 30 seconds
        }

        function openPlayerRoom(player) {
            currentPlayer = player;
            const playerData = gameState[player];
            const content = gameContent[player][`day${playerData.currentDay}`];
            
            if (!content) {
                alert(`Content not yet available for ${player} Day ${playerData.currentDay}`);
                return;
            }

            // Update room display
            document.getElementById('roomIcon').textContent = content.icon;
            document.getElementById('roomName').textContent = content.realm;
            document.getElementById('roomSubtitle').textContent = content.room;
            document.getElementById('roomArtwork').src = content.artwork;
            document.getElementById('storyText').textContent = content.story;

            // Apply player-specific theme classes
            const roomHeader = document.querySelector('.room-header');
            const roomTitle = document.querySelector('.room-title');
            const roomArtwork = document.getElementById('roomArtwork');
            const challengeContents = document.querySelectorAll('.challenge-content');
            const challengeTitles = document.querySelectorAll('.challenge-title');
            
            // Remove existing theme classes
            roomHeader.classList.remove('wells-theme', 'rou-theme');
            roomTitle.classList.remove('wells-theme', 'rou-theme');
            roomArtwork.classList.remove('wells-theme', 'rou-theme');
            challengeContents.forEach(content => {
                content.classList.remove('wells-theme', 'rou-theme');
            });
            challengeTitles.forEach(title => {
                title.classList.remove('wells-theme', 'rou-theme');
            });
            
            // Add current player's theme
            const themeClass = `${player}-theme`;
            roomHeader.classList.add(themeClass);
            roomTitle.classList.add(themeClass);
            roomArtwork.classList.add(themeClass);
            challengeContents.forEach(content => {
                content.classList.add(themeClass);
            });
            challengeTitles.forEach(title => {
                title.classList.add(themeClass);
            });

            // Update challenge buttons
            updateChallengeButtons();
            
            // Generate dynamic mission buttons
            generateMissionButtons(content);

            // Show room modal
            document.getElementById('roomModal').style.display = 'block';
        }

        function closePlayerRoom() {
            document.getElementById('roomModal').style.display = 'none';
            // Hide all challenge content
            document.querySelectorAll('.challenge-content').forEach(content => {
                content.classList.remove('active');
            });
        }

        function updateChallengeButtons() {
            const playerData = gameState[currentPlayer];
            const content = gameContent[currentPlayer][`day${playerData.currentDay}`];
            const irlBtn = document.getElementById('irlChallengeBtn');
            const mathBtn = document.getElementById('mathChallengeBtn');

            // Check if this day has an IRL challenge
            const hasIRLChallenge = content.irlChallenge.type !== 'none';

            if (hasIRLChallenge) {
                // Show IRL button and update its state
                irlBtn.style.display = 'flex';
                if (playerData.irlCompleted) {
                    irlBtn.classList.add('completed');
                    irlBtn.innerHTML = '‚úÖ Harmony Ritual Complete';
                    irlBtn.onclick = null;
                } else {
                    irlBtn.classList.remove('completed');
                    irlBtn.innerHTML = 'üéµ Begin Harmony Ritual';
                    irlBtn.onclick = startIRLChallenge;
                }

                // Math button depends on IRL completion
                if (playerData.mathCompleted) {
                    mathBtn.classList.add('completed');
                    mathBtn.innerHTML = '‚úÖ Ancient Puzzles Complete';
                    mathBtn.disabled = false;
                } else if (playerData.irlCompleted) {
                    mathBtn.disabled = false;
                    mathBtn.innerHTML = 'üîÆ Solve Ancient Puzzles';
                } else {
                    mathBtn.disabled = true;
                    mathBtn.innerHTML = 'üîÆ Solve Ancient Puzzles';
                }
            } else {
                // Hide IRL button for math-only days
                irlBtn.style.display = 'none';
                
                // Math button is always available on math-only days
                if (playerData.mathCompleted) {
                    mathBtn.classList.add('completed');
                    mathBtn.innerHTML = '‚úÖ Crystal Mysteries Complete';
                    mathBtn.disabled = false;
                } else {
                    mathBtn.disabled = false;
                    mathBtn.innerHTML = 'üîÆ Solve Crystal Mysteries';
                }
            }
        }

        function startIRLChallenge() {
            document.getElementById('pianoModal').style.display = 'block';
        }

        function closePianoModal() {
            document.getElementById('pianoModal').style.display = 'none';
        }

        function completePianoChallenge() {
            gameState[currentPlayer].irlCompleted = true;
            updateChallengeButtons();
            closePianoModal();
            
            // Show completion message with custom modal
            showSuccessModal(
                'üéµ',
                'Harmony Achieved!',
                'The Harmony Melody resonates through the Hall! The first sun pillar begins to glow with ancient power. The Ancient Puzzles are now unlocked!',
                currentPlayer,
                () => {
                    // Continue to next challenge
                }
            );
            saveGameState();
        }

        function startMathChallenge() {
            const content = gameContent[currentPlayer][`day${gameState[currentPlayer].currentDay}`];
            const hasIRLChallenge = content.irlChallenge.type !== 'none';
            
            // Only require IRL completion if there is an IRL challenge
            if (hasIRLChallenge && !gameState[currentPlayer].irlCompleted) {
                showCompletionModal(
                    'üîí',
                    'Ancient Pillars Sealed',
                    'Please complete the Harmony Ritual first! The sun pillars must be activated in sequence.',
                    currentPlayer,
                    () => {} // Just close modal
                );
                return;
            }
            
            // UNIFIED FLOW: Both Wells and Rou go directly to first question popup
            openMathQuestion(1);
        }

        function completeIRLChallenge() {
            gameState[currentPlayer].irlCompleted = true;
            updateChallengeButtons();
            alert('üéâ Piano challenge completed! Math missions are now unlocked.');
            saveGameState();
        }

        function submitAnswer(missionNumber, correctAnswer) {
            const answerField = document.getElementById(`answer${missionNumber}`);
            const feedback = document.getElementById(`feedback${missionNumber}`);
            const userAnswer = parseInt(answerField.value);

            feedback.style.display = 'block';

            if (userAnswer === correctAnswer) {
                feedback.textContent = 'üéâ Correct! Well done!';
                feedback.className = 'answer-feedback correct';
                
                // Mark mission as completed
                gameState[currentPlayer].mathProgress = Math.max(gameState[currentPlayer].mathProgress, missionNumber);
                
                // Unlock next mission
                if (missionNumber < 3) {
                    const nextMission = document.getElementById(`mission${missionNumber + 1}`);
                    nextMission.style.opacity = '1';
                    nextMission.style.pointerEvents = 'auto';
                }
                
                // Update progress
                updateMathProgress();
                
                // Disable this mission's input
                answerField.disabled = true;
                answerField.style.background = 'rgba(39,174,96,0.2)';
                
            } else {
                feedback.textContent = '‚ùå Not quite right. Try again!';
                feedback.className = 'answer-feedback incorrect';
            }

            saveGameState();
        }

        function updateMathProgress() {
            const progress = gameState[currentPlayer].mathProgress;
            const isWells = currentPlayer === 'wells';
            
            if (isWells) {
                document.getElementById('mathProgress').textContent = `Puzzle ${Math.min(progress + 1, 3)} of 3`;
                
                if (progress >= 3) {
                    document.getElementById('completeMathBtn').style.display = 'block';
                    document.getElementById('mathProgress').textContent = 'All ancient puzzles solved!';
                }
            } else {
                document.getElementById('mathProgress').textContent = `Mystery ${Math.min(progress + 1, 3)} of 3`;
                
                if (progress >= 3) {
                    document.getElementById('completeMathBtn').style.display = 'block';
                    document.getElementById('mathProgress').textContent = 'All crystal mysteries solved!';
                }
            }
        }

        function completeMathChallenge() {
            if (gameState[currentPlayer].mathProgress < 3) {
                alert('Please complete all 3 math missions first!');
                return;
            }

            gameState[currentPlayer].mathCompleted = true;
            gameState[currentPlayer].completedDays.push(gameState[currentPlayer].currentDay);
            
            // Check for rune reward from official schedule
            const daySchedule = gameSchedule.schedule[`day${gameState[currentPlayer].currentDay}`];
            const playerSchedule = daySchedule[currentPlayer];
            const hasRune = playerSchedule.rune && playerSchedule.rune !== 'None';
            
            // Add the rune to collection if one is awarded
            if (hasRune) {
                addRuneToCollection(currentPlayer, playerSchedule.rune);
            }
            
            updateChallengeButtons();
            
            // Check if this is a math-only day
            const content = gameContent[currentPlayer][`day${gameState[currentPlayer].currentDay}`];
            const hasIRLChallenge = content.irlChallenge.type !== 'none';
            const dayType = hasIRLChallenge ? 'adventure' : 'Crystal Mysteries';
            
            // Check for loot reward from official schedule
            const hasLoot = playerSchedule.loot && playerSchedule.loot !== 'None';
            
            // Show rune discovery modal first if a rune was awarded
            if (hasRune) {
                showRuneDiscoveryModal(currentPlayer, playerSchedule.rune, () => {
                    // After rune modal, show loot modal if applicable, otherwise return to main
                    if (hasLoot) {
                        showLootModal(currentPlayer, gameState[currentPlayer].currentDay, playerSchedule.loot);
                } else {
                        closePlayerRoom();
                    }
                });
            } else if (hasLoot) {
                // Show loot modal, then return to main interface
                showLootModal(currentPlayer, gameState[currentPlayer].currentDay, playerSchedule.loot);
            } else {
                // No rune or loot - return directly to main interface
                closePlayerRoom();
            }
            
            saveGameState();
        }

        function showCompletionMessage(content, dayType) {
            // Check for loot reward from official schedule
            const daySchedule = gameSchedule.schedule[`day${gameState[currentPlayer].currentDay}`];
            const playerSchedule = daySchedule[currentPlayer];
            const hasLoot = playerSchedule.loot && playerSchedule.loot !== 'None';
            
            // Show custom day completion modal instead of browser alert
            showDayCompletionModal(
                currentPlayer, 
                gameState[currentPlayer].currentDay, 
                content, 
                hasLoot, 
                hasLoot ? playerSchedule.loot : null
            );
        }

        function showLootModal(player, day, lootType) {
            const modal = document.getElementById('lootModal');
            const artwork = document.getElementById('lootArtwork');
            const subtitle = document.getElementById('lootSubtitle');
            const description = document.getElementById('lootDescription');
            
            // Configure modal based on player and loot type
            const lootData = getLootData(player, day, lootType);
            
            artwork.src = lootData.artwork;
            artwork.alt = lootData.title;
            subtitle.textContent = lootData.title;
            description.textContent = lootData.description;
            
            modal.style.display = 'block';
        }

        function getLootData(player, day, lootType) {
            const lootConfigs = {
                wells: {
                    day1: {
                        Tiny: {
                            artwork: 'assets/loot/alien-robot-tiny-loot.png',
                            title: 'Tiny Loot Found!',
                            description: 'Hidden within the ancient Hall of Harmonies, you\'ve discovered valuable treasure!'
                        }
                    }
                },
                rou: {
                    // Add Rou's loot configurations as needed
                }
            };
            
            const config = lootConfigs[player]?.[`day${day}`]?.[lootType];
            
            return config || {
                artwork: 'assets/loot/default-loot.png',
                title: `${lootType} Loot Found!`,
                description: 'You\'ve discovered treasure during your adventure!'
            };
        }

        function closeLootModal() {
            document.getElementById('lootModal').style.display = 'none';
            
            // Return directly to main interface (skip Quest Complete modal)
            closePlayerRoom();
        }

        function saveGameState() {
            localStorage.setItem('runeBearerGameState', JSON.stringify(gameState));
        }

        function loadGameState() {
            const saved = localStorage.getItem('runeBearerGameState');
            if (saved) {
                gameState = JSON.parse(saved);
            }
        }

        // Initialize game on page load
        document.addEventListener('DOMContentLoaded', function() {
            loadGameState();
            initGame();
            
            // Initialize rune displays with error handling
            try {
                console.log('Initializing rune displays...');
                updateRuneDisplay('wells');
                updateRuneDisplay('rou');
                console.log('Rune displays initialized successfully');
            } catch (error) {
                console.error('Error initializing rune displays:', error);
            }
        });

        function openMathQuestion(questionNum) {
            currentQuestion = questionNum;
            const content = gameContent[currentPlayer][`day${gameState[currentPlayer].currentDay}`];
            const mission = content.mathChallenge.missions[questionNum - 1];
            
            document.getElementById('mathQuestionTitle').textContent = mission.title;
            document.getElementById('mathStoryContext').textContent = mission.story;
            document.getElementById('mathProblemText').innerHTML = mission.question;
            
            // Apply player-specific theme classes
            const mathQuestionContent = document.querySelector('.math-question-content');
            const mathQuestionHeader = document.querySelector('.math-question-header');
            const mathStoryContext = document.querySelector('.math-story-context');
            
            // Remove existing theme classes
            mathQuestionContent.classList.remove('wells-theme', 'rou-theme');
            mathQuestionHeader.classList.remove('wells-theme', 'rou-theme');
            mathStoryContext.classList.remove('wells-theme', 'rou-theme');
            
            // Add current player's theme
            const themeClass = `${currentPlayer}-theme`;
            mathQuestionContent.classList.add(themeClass);
            mathQuestionHeader.classList.add(themeClass);
            mathStoryContext.classList.add(themeClass);
            
            document.getElementById('mathQuestionModal').style.display = 'block';
        }

        function closeMathQuestion() {
            document.getElementById('mathQuestionModal').style.display = 'none';
        }

        function openNumberInput() {
            const content = gameContent[currentPlayer][`day${gameState[currentPlayer].currentDay}`];
            const mission = content.mathChallenge.missions[currentQuestion - 1];
            // Removed numberQuestionText line since we simplified the modal
            currentInput = '0';
            document.getElementById('numberDisplay').textContent = currentInput;
            
            // Apply player-specific theme classes
            const numberInputContent = document.querySelector('.number-input-content');
            const numberButtons = document.querySelectorAll('.number-btn');
            
            // Remove existing theme classes
            numberInputContent.classList.remove('wells-theme', 'rou-theme');
            numberButtons.forEach(btn => {
                btn.classList.remove('wells-theme', 'rou-theme');
            });
            
            // Add current player's theme
            const themeClass = `${currentPlayer}-theme`;
            numberInputContent.classList.add(themeClass);
            numberButtons.forEach(btn => {
                btn.classList.add(themeClass);
            });
            
            document.getElementById('numberInputModal').style.display = 'block';
        }

        function addNumber(num) {
            if (currentInput === '0') {
                currentInput = num.toString();
            } else {
                currentInput += num.toString();
            }
            document.getElementById('numberDisplay').textContent = currentInput;
        }

        function clearNumber() {
            currentInput = '0';
            document.getElementById('numberDisplay').textContent = currentInput;
        }

        function backspaceNumber() {
            if (currentInput.length > 1) {
                currentInput = currentInput.slice(0, -1);
            } else {
                currentInput = '0';
            }
            document.getElementById('numberDisplay').textContent = currentInput;
        }

        function submitNumber() {
            const answer = parseInt(currentInput);
            const content = gameContent[currentPlayer][`day${gameState[currentPlayer].currentDay}`];
            const mission = content.mathChallenge.missions[currentQuestion - 1];
            const correctAnswer = mission.answer;
            
            if (answer === correctAnswer) {
                // Correct answer - close modals first
                document.getElementById('numberInputModal').style.display = 'none';
                document.getElementById('mathQuestionModal').style.display = 'none';
                
                // Update progress
                gameState[currentPlayer].mathProgress = Math.max(gameState[currentPlayer].mathProgress, currentQuestion);
                
                // Check if this is a math-only day (no mission buttons interface)
                const hasIRLChallenge = content.irlChallenge.type !== 'none';
                
                if (hasIRLChallenge) {
                    // Wells-style: Update mission buttons (optional/legacy - will be removed)
                    const missionBtn = document.getElementById(`mission${currentQuestion}Btn`);
                    if (missionBtn) {
                        missionBtn.style.opacity = '1';
                        missionBtn.style.background = 'linear-gradient(135deg, var(--success-green), #16a34a)';
                        missionBtn.style.borderColor = 'var(--success-green)';
                        missionBtn.innerHTML = missionBtn.innerHTML.replace(/^[‚≠êüíéüèõÔ∏èüßäüéÅ]/, '‚úÖ');
                        missionBtn.disabled = true;
                        missionBtn.style.cursor = 'not-allowed';
                    }
                    
                    // Unlock next mission
                    if (currentQuestion < 3) {
                        const nextBtn = document.getElementById(`mission${currentQuestion + 1}Btn`);
                        if (nextBtn) {
                            nextBtn.style.opacity = '1';
                            nextBtn.style.cursor = 'pointer';
                            nextBtn.disabled = false;
                        }
                    }
                }
                
                // Show custom success message instead of browser alert
                const isWells = currentPlayer === 'wells';
                const wellsMessages = [
                    'The sacred geometry reveals its secrets - the pillars align with ancient power!',
                    'The crystal chambers resonate with pure energy - the Rune Gate stirs!',
                    'The treasure is divided with perfect fairness - the Guild honors your wisdom!'
                ];
                
                const rouMessages = [
                    'You gathered all the blue crystals - they sparkle with magical energy!',
                    'You carefully counted your remaining frost gems - they glow safely in your pouch!',
                    'You discovered all the magic orbs - they might unlock the ice gate!'
                ];
                
                const messages = isWells ? wellsMessages : rouMessages;
                const successIcons = ['‚≠ê', 'üíé', 'üèõÔ∏è', 'üßä', 'üéÅ'];
                
                showSuccessModal(
                    successIcons[currentQuestion - 1] || '‚ú®',
                    'Mystery Solved!',
                    messages[currentQuestion - 1],
                    currentPlayer,
                    () => {
                        // UNIFIED PROGRESSION LOGIC: Always move to next question for both players
                        if (currentQuestion < 3) {
                            // Move to next question automatically for both Wells and Rou
                            setTimeout(() => {
                                openMathQuestion(currentQuestion + 1);
                            }, 300);
                    } else {
                            // All questions completed - directly complete the challenge
                            setTimeout(() => {
                                completeMathChallenge();
                            }, 300);
                        }
                    }
                );
                
            } else {
                // Wrong answer - don't close modals, just show error and retry
                const isWells = currentPlayer === 'wells';
                const errorMessage = isWells 
                    ? 'The ancient magic requires the correct calculation. The mystical forces resist... Try again!'
                    : 'The ice crystals dim when the answer is wrong. Count carefully and try again!';
                
                showSuccessModal(
                    '‚ùå',
                    'Try Again!',
                    errorMessage,
                    currentPlayer,
                    () => {
                        // Reset the number input and reopen the same question
                        currentInput = '0';
                        document.getElementById('numberDisplay').textContent = currentInput;
                        // Don't close modals - they'll stay open for retry
                    }
                );
            }
            
            saveGameState();
        }

        // Success Modal Functions
        function showSuccessModal(icon, title, message, playerTheme, onContinue) {
            const modal = document.getElementById('successModal');
            const modalContent = document.getElementById('successModalContent');
            const header = document.getElementById('successHeader');
            const titleElement = document.getElementById('successTitle');
            const continueBtn = document.getElementById('successContinueBtn');
            
            // Set content
            document.getElementById('successIcon').textContent = icon;
            titleElement.textContent = title;
            document.getElementById('successMessage').textContent = message;
            
            // Apply theme
            modalContent.className = `success-modal-content ${playerTheme}-theme`;
            header.className = `success-header ${playerTheme}-theme`;
            titleElement.className = `success-title ${playerTheme}-theme`;
            continueBtn.className = `success-continue-btn ${playerTheme}-theme`;
            
            // Set continue action
            continueBtn.onclick = () => {
                closeSuccessModal();
                if (onContinue) onContinue();
            };
            
            modal.style.display = 'block';
        }

        function closeSuccessModal() {
            document.getElementById('successModal').style.display = 'none';
        }

        function showDayCompletionChoice(dayType) {
            // Show custom completion confirmation modal instead of browser confirm
            const modal = document.getElementById('completionConfirmModal');
            const message = document.getElementById('completionConfirmMessage');
            
            // Update message dynamically
            message.textContent = `All ${dayType} solved! Ready to complete your quest for today?`;
            
            // Store the completion choice for later
            window.pendingCompletion = true;
            
            // Show the modal
            modal.style.display = 'flex';
        }

        function closeCompletionConfirm() {
            document.getElementById('completionConfirmModal').style.display = 'none';
            window.pendingCompletion = false;
            closePlayerRoom();
        }

        function confirmCompletion() {
            document.getElementById('completionConfirmModal').style.display = 'none';
            window.pendingCompletion = false;
            completeMathChallenge();
        }

        // Day Completion Modal Functions
        function showDayCompletionModal(player, day, content, hasLoot, lootItem) {
            const modal = document.getElementById('dayCompletionModal');
            const header = document.getElementById('dayCompletionHeader');
            const title = document.getElementById('dayCompletionTitle');
            const location = document.getElementById('dayCompletionLocation');
            const tasks = document.getElementById('dayCompletionTasks');
            const runeSection = document.getElementById('dayCompletionRune');
            const continueBtn = document.getElementById('dayCompletionContinue');
            
            // Player-specific theming
            if (player === 'Wells') {
                header.style.background = 'linear-gradient(135deg, #f59e0b, #d97706)';
                header.innerHTML = '<span class="completion-icon">üëë</span><div class="completion-title">Quest Complete!</div>';
            } else {
                header.style.background = 'linear-gradient(135deg, #3b82f6, #1d4ed8)';
                header.innerHTML = '<span class="completion-icon">üëë</span><div class="completion-title">Quest Complete!</div>';
            }
            
            // Set location name
            location.textContent = content.location || 'Mystical Realm';
            
            // Create task checklist
            tasks.innerHTML = `
                <div class="task-item completed">
                    <span class="task-check">‚úÖ</span>
                    <span class="task-text">Piano Challenge Mastered</span>
                </div>
                <div class="task-item completed">
                    <span class="task-check">‚úÖ</span>
                    <span class="task-text">Math Mysteries Solved</span>
                </div>
                ${hasLoot ? `
                <div class="task-item completed">
                    <span class="task-check">‚úÖ</span>
                    <span class="task-text">Treasure Discovered: ${lootItem}</span>
                </div>` : ''}
            `;
            
            // Show rune discovery
            if (content.runeReward) {
                runeSection.innerHTML = `
                    <div class="rune-discovery">
                        <div class="rune-found-text">Ancient Rune Discovered!</div>
                        <div class="rune-display">
                            <span class="rune-icon">${content.runeReward.icon}</span>
                            <span class="rune-name">${content.runeReward.name}</span>
                        </div>
                    </div>
                `;
                runeSection.style.display = 'block';
            } else {
                runeSection.style.display = 'none';
            }
            
            modal.style.display = 'flex';
        }

        function closeDayCompletionModal() {
            document.getElementById('dayCompletionModal').style.display = 'none';
            closePlayerRoom();
        }

        function generateMissionButtons(content) {
            const container = document.getElementById('mathMissionButtons');
            container.innerHTML = ''; // Clear existing buttons
            
            // Update challenge title based on player
            const challengeTitle = document.querySelector('#mathChallengeContent .challenge-title');
            challengeTitle.textContent = content.mathChallenge.title;
            
            content.mathChallenge.missions.forEach((mission, index) => {
                const missionNum = index + 1;
                const playerData = gameState[currentPlayer];
                
                const button = document.createElement('button');
                button.className = 'math-answer-btn';
                button.id = `mission${missionNum}Btn`;
                button.onclick = () => openMathQuestion(missionNum);
                
                // Extract emoji and title from mission.title
                const missionTitle = mission.title;
                button.innerHTML = missionTitle;
                
                // Set initial state based on progress
                if (playerData.mathProgress >= missionNum) {
                    // Completed
                    button.style.opacity = '1';
                    button.style.background = 'linear-gradient(135deg, var(--success-green), #16a34a)';
                    button.style.borderColor = 'var(--success-green)';
                    button.innerHTML = button.innerHTML.replace(/^[‚≠êüíéüèõÔ∏èüßäüéÅ]/, '‚úÖ');
                    button.disabled = true;
                    button.style.cursor = 'not-allowed';
                } else if (missionNum === 1 || playerData.mathProgress >= missionNum - 1) {
                    // Available
                    button.style.opacity = '1';
                    button.style.cursor = 'pointer';
                    button.disabled = false;
                } else {
                    // Locked
                    button.style.opacity = '0.5';
                    button.style.cursor = 'not-allowed';
                    button.disabled = true;
                }
                
                container.appendChild(button);
            });
        }

        // Audio Help Functionality
        function toggleAudioHelp() {
            const audio = document.getElementById('helpAudio');
            const button = document.querySelector('.audio-help-btn');
            const audioText = document.querySelector('.audio-text');
            const audioIcon = document.querySelector('.audio-icon');
            
            if (audio.paused) {
                // Start playing
                audio.play().then(() => {
                    button.classList.add('playing');
                    audioText.textContent = 'Playing...';
                    audioIcon.textContent = '‚è∏Ô∏è';
                }).catch(error => {
                    console.error('Error playing audio:', error);
                    alert('Unable to play audio. Please check your browser settings.');
                });
            } else {
                // Pause playing
                audio.pause();
                button.classList.remove('playing');
                audioText.textContent = 'How to Play';
                audioIcon.textContent = 'üîä';
            }
        }

        // Audio event listeners
        document.addEventListener('DOMContentLoaded', function() {
            const audio = document.getElementById('helpAudio');
            const button = document.querySelector('.audio-help-btn');
            const audioText = document.querySelector('.audio-text');
            const audioIcon = document.querySelector('.audio-icon');
            
            if (audio && button) {
                // Handle audio ending
                audio.addEventListener('ended', function() {
                    button.classList.remove('playing');
                    audioText.textContent = 'How to Play';
                    audioIcon.textContent = 'üîä';
                });
                
                // Handle audio loading errors
                audio.addEventListener('error', function() {
                    console.error('Error loading audio file');
                    button.style.opacity = '0.6';
                    audioText.textContent = 'Audio Unavailable';
                    button.disabled = true;
                });
            }
            
            // Rest of existing DOMContentLoaded code
            loadGameState();
            initGame();
            
            // Initialize rune displays with error handling
            try {
                console.log('Initializing rune displays...');
                updateRuneDisplay('wells');
                updateRuneDisplay('rou');
                console.log('Rune displays initialized successfully');
            } catch (error) {
                console.error('Error initializing rune displays:', error);
            }
        });

        function resetGameState() {
            // Implement the logic to reset the game state
            console.log('Resetting game state...');
            gameState = {
                wells: {
                    currentDay: 1,
                    currentRealm: 'Dawnbreak Expanse',
                    irlCompleted: false,
                    mathCompleted: false,
                    mathProgress: 0,
                    completedDays: [],
                    collectedRunes: [] // Empty - true reset
                },
                rou: {
                    currentDay: 1,
                    currentRealm: 'Crystal Glade',
                    irlCompleted: false,
                    mathCompleted: false,
                    mathProgress: 0,
                    completedDays: [],
                    collectedRunes: []
                }
            };
            localStorage.removeItem('runeBearerGameState'); // Clear saved data too
            saveGameState();
            console.log('Game state reset successfully - all progress cleared');
            
            // Use custom modal for reset confirmation too
            showSuccessModal(
                'üîÑ',
                'Game Reset!',
                'All progress and runes have been cleared. Your adventure begins anew!',
                'wells', // Default theme
                () => {
                    updateRuneDisplay('wells');
                    updateRuneDisplay('rou');
                }
            );
        }

        // Rune Discovery Modal Functions
        function showRuneDiscoveryModal(player, runeName, onContinue) {
            // Find the rune data from the collections
            const rune = runeCollections[player].find(r => r.name === runeName);
            if (!rune) {
                console.error(`Rune not found: ${runeName} for player ${player}`);
                return;
            }

            const modal = document.getElementById('runeDiscoveryModal');
            const content = document.getElementById('runeDiscoveryContent');
            const header = document.getElementById('runeDiscoveryHeader');
            const title = document.querySelector('.rune-discovery-title');
            const runeElement = document.querySelector('.discovered-rune');
            const runeNameElement = document.getElementById('discoveredRuneName');
            const continueBtn = document.getElementById('runeDiscoveryContinue');

            // Set rune details
            document.getElementById('discoveredRuneEmoji').textContent = rune.emoji;
            document.getElementById('discoveredRuneName').textContent = rune.name;

            // Apply player-specific theming
            const themeClass = `${player}-theme`;
            
            // Remove existing theme classes
            content.classList.remove('wells-theme', 'rou-theme');
            header.classList.remove('wells-theme', 'rou-theme');
            title.classList.remove('wells-theme', 'rou-theme');
            runeElement.classList.remove('wells-theme', 'rou-theme');
            runeNameElement.classList.remove('wells-theme', 'rou-theme');
            continueBtn.classList.remove('wells-theme', 'rou-theme');

            // Add current player's theme
            content.classList.add(themeClass);
            header.classList.add(themeClass);
            title.classList.add(themeClass);
            runeElement.classList.add(themeClass);
            runeNameElement.classList.add(themeClass);
            continueBtn.classList.add(themeClass);

            // Set continue action
            continueBtn.onclick = () => {
                closeRuneDiscoveryModal();
                if (onContinue) onContinue();
            };

            // Show the modal with animation
            modal.style.display = 'block';
            
            // Add a slight delay for better visual effect
            setTimeout(() => {
                modal.classList.add('active');
            }, 50);
        }

        function closeRuneDiscoveryModal() {
            const modal = document.getElementById('runeDiscoveryModal');
            modal.style.display = 'none';
            modal.classList.remove('active');
        }
    </script>
</body>
</html> 